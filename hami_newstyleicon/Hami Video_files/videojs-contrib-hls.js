!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.videojsContribHls=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=function(b,c){return b.start(c)+"-"+b.end(c)},e=function(b,c){var d=b.toString(16);return"00".substring(0,2-d.length)+d+(c%2?" ":"")},f=function(b){return b>=32&&b<126?String.fromCharCode(b):"."},g={hexDump:function(b){for(var c=Array.prototype.slice.call(b),d=16,g="",h=void 0,i=void 0,j=0;j<c.length/d;j++)h=c.slice(j*d,j*d+d).map(e).join(""),i=c.slice(j*d,j*d+d).map(f).join(""),g+=h+" "+i+"\n";return g},tagDump:function(b){return g.hexDump(b.bytes)},textRanges:function(b){var c="",e=void 0;for(e=0;e<b.length;e++)c+=d(b,e)+" ";return c}};c.default=g,b.exports=c.default},{}],2:[function(a,b,c){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){var b=[[[],[],[],[],[]],[[],[],[],[],[]]],c=b[0],d=b[1],e=c[4],f=d[4],g=void 0,h=void 0,i=void 0,j=[],k=[],l=void 0,m=void 0,n=void 0,o=void 0,p=void 0,q=void 0;for(g=0;g<256;g++)k[(j[g]=g<<1^283*(g>>7))^g]=g;for(h=i=0;!e[h];h^=l||1,i=k[i]||1)for(o=i^i<<1^i<<2^i<<3^i<<4,o=o>>8^255&o^99,e[h]=o,f[o]=h,n=j[m=j[l=j[h]]],q=16843009*n^65537*m^257*l^16843008*h,p=257*j[o]^16843008*o,g=0;g<4;g++)c[g][h]=p=p<<24^p>>>8,d[g][o]=q=q<<24^q>>>8;for(g=0;g<5;g++)c[g]=c[g].slice(0),d[g]=d[g].slice(0);return b},g=null,h=function(){function a(b){e(this,a),g||(g=f()),this._tables=[[g[0][0].slice(),g[0][1].slice(),g[0][2].slice(),g[0][3].slice(),g[0][4].slice()],[g[1][0].slice(),g[1][1].slice(),g[1][2].slice(),g[1][3].slice(),g[1][4].slice()]];var c=void 0,d=void 0,h=void 0,i=void 0,j=void 0,k=this._tables[0][4],l=this._tables[1],m=b.length,n=1;if(4!==m&&6!==m&&8!==m)throw new Error("Invalid aes key size");for(i=b.slice(0),j=[],this._key=[i,j],c=m;c<4*m+28;c++)h=i[c-1],(c%m==0||8===m&&c%m==4)&&(h=k[h>>>24]<<24^k[h>>16&255]<<16^k[h>>8&255]<<8^k[255&h],c%m==0&&(h=h<<8^h>>>24^n<<24,n=n<<1^283*(n>>7))),i[c]=i[c-m]^h;for(d=0;c;d++,c--)h=i[3&d?c:c-4],j[d]=c<=4||d<4?h:l[0][k[h>>>24]]^l[1][k[h>>16&255]]^l[2][k[h>>8&255]]^l[3][k[255&h]]}return d(a,[{key:"decrypt",value:function(b,c,d,e,f,g){var h=this._key[1],i=b^h[0],j=e^h[1],k=d^h[2],l=c^h[3],m=void 0,n=void 0,o=void 0,p=h.length/4-2,q=void 0,r=4,s=this._tables[1],t=s[0],u=s[1],v=s[2],w=s[3],x=s[4];for(q=0;q<p;q++)m=t[i>>>24]^u[j>>16&255]^v[k>>8&255]^w[255&l]^h[r],n=t[j>>>24]^u[k>>16&255]^v[l>>8&255]^w[255&i]^h[r+1],o=t[k>>>24]^u[l>>16&255]^v[i>>8&255]^w[255&j]^h[r+2],l=t[l>>>24]^u[i>>16&255]^v[j>>8&255]^w[255&k]^h[r+3],r+=4,i=m,j=n,k=o;for(q=0;q<4;q++)f[(3&-q)+g]=x[i>>>24]<<24^x[j>>16&255]<<16^x[k>>8&255]<<8^x[255&l]^h[r++],m=i,i=j,j=k,k=l,l=m}}]),a}();c.default=h,b.exports=c.default},{}],3:[function(a,b,c){"use strict";function f(a){return a&&a.__esModule?a:{default:a}}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(b,c,d){for(var e=!0;e;){var f=b,g=c,h=d;e=!1,null===f&&(f=Function.prototype);var i=Object.getOwnPropertyDescriptor(f,g);if(void 0!==i){if("value"in i)return i.value;var k=i.get;if(void 0===k)return;return k.call(h)}var j=Object.getPrototypeOf(f);if(null===j)return;b=j,c=g,d=h,e=!0,i=j=void 0}},i=a("../stream"),j=f(i),k=function(a){function b(){g(this,b),e(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,j.default),this.jobs=[],this.delay=1,this.timeout_=null}return h(b,a),d(b,[{key:"processJob_",value:function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}},{key:"push",value:function(b){this.jobs.push(b),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}]),b}(j.default);c.default=k,b.exports=c.default},{"../stream":18}],4:[function(a,b,c){"use strict";function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./aes"),h=e(g),i=a("./async-stream"),j=e(i),k=a("pkcs7"),l=function(b){return b<<24|(65280&b)<<8|(16711680&b)>>8|b>>>24},m=function(b,c,d){var e=new Int32Array(b.buffer,b.byteOffset,b.byteLength>>2),f=new h.default(Array.prototype.slice.call(c)),g=new Uint8Array(b.byteLength),i=new Int32Array(g.buffer),j=void 0,k=void 0,m=void 0,n=void 0,o=void 0,p=void 0,q=void 0,r=void 0,s=void 0;for(j=d[0],k=d[1],m=d[2],n=d[3],s=0;s<e.length;s+=4)o=l(e[s]),p=l(e[s+1]),q=l(e[s+2]),r=l(e[s+3]),f.decrypt(o,p,q,r,i,s),i[s]=l(i[s]^j),i[s+1]=l(i[s+1]^k),i[s+2]=l(i[s+2]^m),i[s+3]=l(i[s+3]^n),j=o,k=p,m=q,n=r;return g};c.decrypt=m;var n=function(){function a(b,c,d,e){f(this,a);var g=a.STEP,h=new Int32Array(b.buffer),i=new Uint8Array(b.byteLength),m=0;for(this.asyncStream_=new j.default,this.asyncStream_.push(this.decryptChunk_(h.subarray(m,m+g),c,d,i)),m=g;m<h.length;m+=g)d=new Uint32Array([l(h[m-4]),l(h[m-3]),l(h[m-2]),l(h[m-1])]),this.asyncStream_.push(this.decryptChunk_(h.subarray(m,m+g),c,d,i));this.asyncStream_.push(function(){e(null,(0,k.unpad)(i))})}return d(a,[{key:"decryptChunk_",value:function(b,c,d,e){return function(){var a=m(b,c,d);e.set(a,b.byteOffset)}}}],[{key:"STEP",get:function(){return 32e3}}]),a}();c.Decrypter=n,c.default={Decrypter:n,decrypt:m}},{"./aes":2,"./async-stream":3,pkcs7:23}],5:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("./decrypter"),f=a("./async-stream"),g=d(f);c.default={decrypt:e.decrypt,Decrypter:e.Decrypter,AsyncStream:g.default},b.exports=c.default},{"./async-stream":3,"./decrypter":4}],6:[function(a,b,c){(function(d){"use strict";function g(a){return a&&a.__esModule?a:{default:a}}function h(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function i(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(b,c,d){for(var e=!0;e;){var f=b,g=c,h=d;e=!1,null===f&&(f=Function.prototype);var i=Object.getOwnPropertyDescriptor(f,g);if(void 0!==i){if("value"in i)return i.value;var k=i.get;if(void 0===k)return;return k.call(h)}var j=Object.getPrototypeOf(f);if(null===j)return;b=j,c=g,d=h,e=!0,i=j=void 0}},j="undefined"!=typeof window?window.videojs:void 0!==d?d.videojs:null,k=a("./playlist-loader"),l=g(k),m=function(a){function b(a){h(this,b),f(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,{kind:a.default?"main":"alternative",enabled:a.default||!1,language:a.language,label:a.label}),this.hls=a.hls,this.autoselect=a.autoselect||!1,this.default=a.default||!1,this.withCredentials=a.withCredentials||!1,this.mediaGroups_=[],this.addLoader(a.mediaGroup,a.resolvedUri)}return i(b,a),e(b,[{key:"getLoader",value:function(b){for(var c=0;c<this.mediaGroups_.length;c++){var d=this.mediaGroups_[c];if(d.mediaGroup===b)return d.loader}}},{key:"addLoader",value:function(b){var c=arguments.length<=1||void 0===arguments[1]?null:arguments[1],d=null;c&&(d=new l.default(c,this.hls,this.withCredentials)),this.mediaGroups_.push({mediaGroup:b,loader:d})}},{key:"removeLoader",value:function(b){for(var c=0;c<this.mediaGroups_.length;c++){var d=this.mediaGroups_[c];if(d.mediaGroup===b)return d.loader&&d.loader.dispose(),void this.mediaGroups_.splice(c,1)}}},{key:"dispose",value:function(){for(var b=this.mediaGroups_.length;b--;)this.removeLoader(this.mediaGroups_[b].mediaGroup)}}]),b}(j.AudioTrack);c.default=m,b.exports=c.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./playlist-loader":12}],7:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("./line-stream"),f=d(e),g=a("./parse-stream"),h=d(g),i=a("./parser"),j=d(i);c.default={LineStream:f.default,ParseStream:h.default,Parser:j.default},b.exports=c.default},{"./line-stream":8,"./parse-stream":9,"./parser":10}],8:[function(a,b,c){"use strict";function f(a){return a&&a.__esModule?a:{default:a}}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(b,c,d){for(var e=!0;e;){var f=b,g=c,h=d;e=!1,null===f&&(f=Function.prototype);var i=Object.getOwnPropertyDescriptor(f,g);if(void 0!==i){if("value"in i)return i.value;var k=i.get;if(void 0===k)return;return k.call(h)}var j=Object.getPrototypeOf(f);if(null===j)return;b=j,c=g,d=h,e=!0,i=j=void 0}},i=a("../stream"),j=f(i),k=function(a){function b(){g(this,b),e(Object.getPrototypeOf(b.prototype),"constructor",this).call(this),this.buffer=""}return h(b,a),d(b,[{key:"push",value:function(b){var c=void 0;for(this.buffer+=b,c=this.buffer.indexOf("\n");c>-1;c=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,c)),this.buffer=this.buffer.substring(c+1)}}]),b}(j.default);c.default=k,b.exports=c.default},{"../stream":18}],9:[function(a,b,c){"use strict";function f(a){return a&&a.__esModule?a:{default:a}}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(b,c,d){for(var e=!0;e;){var f=b,g=c,h=d;e=!1,null===f&&(f=Function.prototype);var i=Object.getOwnPropertyDescriptor(f,g);if(void 0!==i){if("value"in i)return i.value;var k=i.get;if(void 0===k)return;return k.call(h)}var j=Object.getPrototypeOf(f);if(null===j)return;b=j,c=g,d=h,e=!0,i=j=void 0}},i=a("../stream"),j=f(i),k=function(){var b="[^=]*",c='"[^"]*"|[^,]*',d="(?:"+b+")=(?:"+c+")";return new RegExp("(?:^|,)("+d+")")},l=function(b){for(var c=b.split(k()),d=c.length,e={},f=void 0;d--;)""!==c[d]&&(f=/([^=]*)=(.*)/.exec(c[d]).slice(1),f[0]=f[0].replace(/^\s+|\s+$/g,""),f[1]=f[1].replace(/^\s+|\s+$/g,""),f[1]=f[1].replace(/^['"](.*)['"]$/g,"$1"),e[f[0]]=f[1]);return e},m=function(a){function b(){g(this,b),e(Object.getPrototypeOf(b.prototype),"constructor",this).call(this)}return h(b,a),d(b,[{key:"push",value:function(b){var c=void 0,d=void 0;if(b=b.replace(/^[\u0000\s]+|[\u0000\s]+$/g,""),0!==b.length){if("#"!==b[0])return void this.trigger("data",{type:"uri",uri:b});if(0!==b.indexOf("#EXT"))return void this.trigger("data",{type:"comment",text:b.slice(1)});if(b=b.replace("\r",""),c=/^#EXTM3U/.exec(b))return void this.trigger("data",{type:"tag",tagType:"m3u"});if(c=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(b))return d={type:"tag",tagType:"inf"},c[1]&&(d.duration=parseFloat(c[1])),c[2]&&(d.title=c[2]),void this.trigger("data",d);if(c=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(b))return d={type:"tag",tagType:"targetduration"},c[1]&&(d.duration=parseInt(c[1],10)),void this.trigger("data",d);if(c=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(b))return d={type:"tag",tagType:"totalduration"},c[1]&&(d.duration=parseInt(c[1],10)),void this.trigger("data",d);if(c=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(b))return d={type:"tag",tagType:"version"},c[1]&&(d.version=parseInt(c[1],10)),void this.trigger("data",d);if(c=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(b))return d={type:"tag",tagType:"media-sequence"},c[1]&&(d.number=parseInt(c[1],10)),void this.trigger("data",d);if(c=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(b))return d={type:"tag",tagType:"discontinuity-sequence"},c[1]&&(d.number=parseInt(c[1],10)),void this.trigger("data",d);if(c=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(b))return d={type:"tag",tagType:"playlist-type"},c[1]&&(d.playlistType=c[1]),void this.trigger("data",d);if(c=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(b))return d={type:"tag",tagType:"byterange"},c[1]&&(d.length=parseInt(c[1],10)),c[2]&&(d.offset=parseInt(c[2],10)),void this.trigger("data",d);if(c=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(b))return d={type:"tag",tagType:"allow-cache"},c[1]&&(d.allowed=!/NO/.test(c[1])),void this.trigger("data",d);if(c=/^#EXT-X-STREAM-INF:?(.*)$/.exec(b)){if(d={type:"tag",tagType:"stream-inf"},c[1]){if(d.attributes=l(c[1]),d.attributes.RESOLUTION){var e=d.attributes.RESOLUTION.split("x"),f={};e[0]&&(f.width=parseInt(e[0],10)),e[1]&&(f.height=parseInt(e[1],10)),d.attributes.RESOLUTION=f}d.attributes.BANDWIDTH&&(d.attributes.BANDWIDTH=parseInt(d.attributes.BANDWIDTH,10)),d.attributes["PROGRAM-ID"]&&(d.attributes["PROGRAM-ID"]=parseInt(d.attributes["PROGRAM-ID"],10))}return void this.trigger("data",d)}if(c=/^#EXT-X-MEDIA:?(.*)$/.exec(b))return d={type:"tag",tagType:"media"},c[1]&&(d.attributes=l(c[1])),void this.trigger("data",d);if(c=/^#EXT-X-ENDLIST/.exec(b))return void this.trigger("data",{type:"tag",tagType:"endlist"});if(c=/^#EXT-X-DISCONTINUITY/.exec(b))return void this.trigger("data",{type:"tag",tagType:"discontinuity"});if(c=/^#EXT-X-KEY:?(.*)$/.exec(b))return d={type:"tag",tagType:"key"},c[1]&&(d.attributes=l(c[1]),d.attributes.IV&&("0x"===d.attributes.IV.substring(0,2).toLowerCase()&&(d.attributes.IV=d.attributes.IV.substring(2)),d.attributes.IV=d.attributes.IV.match(/.{8}/g),d.attributes.IV[0]=parseInt(d.attributes.IV[0],16),d.attributes.IV[1]=parseInt(d.attributes.IV[1],16),d.attributes.IV[2]=parseInt(d.attributes.IV[2],16),d.attributes.IV[3]=parseInt(d.attributes.IV[3],16),d.attributes.IV=new Uint32Array(d.attributes.IV))),void this.trigger("data",d);this.trigger("data",{type:"tag",data:b.slice(4,b.length)})}}}]),b}(j.default);c.default=m,b.exports=c.default},{"../stream":18}],10:[function(a,b,c){(function(d){"use strict";function g(a){return a&&a.__esModule?a:{default:a}}function h(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function i(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(b,c,d){for(var e=!0;e;){var f=b,g=c,h=d;e=!1,null===f&&(f=Function.prototype);var i=Object.getOwnPropertyDescriptor(f,g);if(void 0!==i){if("value"in i)return i.value;var k=i.get;if(void 0===k)return;return k.call(h)}var j=Object.getPrototypeOf(f);if(null===j)return;b=j,c=g,d=h,e=!0,i=j=void 0}},j=a("../stream"),k=g(j),l=a("./line-stream"),m=g(l),n=a("./parse-stream"),o=g(n),p="undefined"!=typeof window?window.videojs:void 0!==d?d.videojs:null,q=function(a){function b(){h(this,b),f(Object.getPrototypeOf(b.prototype),"constructor",this).call(this),this.lineStream=new m.default,this.parseStream=new o.default,this.lineStream.pipe(this.parseStream);var a=this,c=[],d={},e=void 0,g=function(){},i={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},j=0;this.manifest={allowCache:!0,discontinuityStarts:[]},this.parseStream.on("data",function(b){var f=void 0,h=void 0;({tag:function(){(({"allow-cache":function(){this.manifest.allowCache=b.allowed,"allowed"in b||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var a={};"length"in b&&(d.byterange=a,a.length=b.length,"offset"in b||(this.trigger("info",{message:"defaulting offset to zero"}),b.offset=0)),"offset"in b&&(d.byterange=a,a.offset=b.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),b.duration>=0&&(d.duration=b.duration),this.manifest.segments=c},key:function(){return b.attributes?"NONE"===b.attributes.METHOD?void(e=null):b.attributes.URI?(b.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),e={method:b.attributes.METHOD||"AES-128",uri:b.attributes.URI},void(void 0!==b.attributes.IV&&(e.iv=b.attributes.IV))):void this.trigger("warn",{message:"ignoring key declaration without URI"}):void this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){if(!isFinite(b.number))return void this.trigger("warn",{message:"ignoring invalid media sequence: "+b.number});this.manifest.mediaSequence=b.number},"discontinuity-sequence":function(){if(!isFinite(b.number))return void this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+b.number});this.manifest.discontinuitySequence=b.number,j=b.number},"playlist-type":function(){if(!/VOD|EVENT/.test(b.playlistType))return void this.trigger("warn",{message:"ignoring unknown playlist type: "+b.playlist});this.manifest.playlistType=b.playlistType},"stream-inf":function(){if(this.manifest.playlists=c,this.manifest.mediaGroups=this.manifest.mediaGroups||i,!b.attributes)return void this.trigger("warn",{message:"ignoring empty stream-inf attributes"});d.attributes||(d.attributes={}),d.attributes=(0,p.mergeOptions)(d.attributes,b.attributes)},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||i,!(b.attributes&&b.attributes.TYPE&&b.attributes["GROUP-ID"]&&b.attributes.NAME))return void this.trigger("warn",{message:"ignoring incomplete or missing media group"});var c=this.manifest.mediaGroups[b.attributes.TYPE];c[b.attributes["GROUP-ID"]]=c[b.attributes["GROUP-ID"]]||{},f=c[b.attributes["GROUP-ID"]],h={default:/yes/i.test(b.attributes.DEFAULT)},h.default?h.autoselect=!0:h.autoselect=/yes/i.test(b.attributes.AUTOSELECT),b.attributes.LANGUAGE&&(h.language=b.attributes.LANGUAGE),b.attributes.URI&&(h.uri=b.attributes.URI),f[b.attributes.NAME]=h},discontinuity:function(){j+=1,d.discontinuity=!0,this.manifest.discontinuityStarts.push(c.length)},targetduration:function(){if(!isFinite(b.duration)||b.duration<0)return void this.trigger("warn",{message:"ignoring invalid target duration: "+b.duration});this.manifest.targetDuration=b.duration},totalduration:function(){if(!isFinite(b.duration)||b.duration<0)return void this.trigger("warn",{message:"ignoring invalid total duration: "+b.duration});this.manifest.totalDuration=b.duration}})[b.tagType]||g).call(a)},uri:function(){d.uri=b.uri,c.push(d),!this.manifest.targetDuration||"duration"in d||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),d.duration=this.manifest.targetDuration),e&&(d.key=e),d.timeline=j,d={}},comment:function(){}})[b.type].call(a)})}return i(b,a),e(b,[{key:"push",value:function(b){this.lineStream.push(b)}},{key:"end",value:function(){this.lineStream.push("\n")}}]),b}(k.default);c.default=q,b.exports=c.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../stream":18,"./line-stream":8,"./parse-stream":9}],11:[function(a,b,c){(function(d){"use strict";function g(a){return a&&a.__esModule?a:{default:a}}function h(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function i(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(b,c,d){for(var e=!0;e;){var f=b,g=c,h=d;e=!1,null===f&&(f=Function.prototype);var i=Object.getOwnPropertyDescriptor(f,g);if(void 0!==i){if("value"in i)return i.value;var k=i.get;if(void 0===k)return;return k.call(h)}var j=Object.getPrototypeOf(f);if(null===j)return;b=j,c=g,d=h,e=!0,i=j=void 0}},j=a("./playlist-loader"),k=g(j),l=a("./segment-loader"),m=g(l),n=a("./ranges"),o=g(n),p="undefined"!=typeof window?window.videojs:void 0!==d?d.videojs:null,q=g(p),r=a("./hls-audio-track"),s=g(r),t=3e5,u=void 0,v=function(b){var c={codecCount:0,videoCodec:null,audioProfile:null};return c.codecCount=b.split(",").length,c.codecCount=c.codecCount||2,c.videoCodec=/(^|\s|,)+(avc1)[^ ,]*/i.exec(b),c.videoCodec=c.videoCodec&&c.videoCodec[2],c.audioProfile=/(^|\s|,)+mp4a.\d+\.(\d+)/i.exec(b),c.audioProfile=c.audioProfile&&c.audioProfile[2],c},w=function(a){function b(a){var c=this,d=a.url,e=a.withCredentials,g=a.mode,i=a.tech,j=a.bandwidth,l=a.externHls;h(this,b),f(Object.getPrototypeOf(b.prototype),"constructor",this).call(this),u=l,this.withCredentials=e,this.tech_=i,this.hls_=i.hls,this.mode_=g,this.audioTracks_=[],this.mediaSource=new q.default.MediaSource({mode:g}),this.mediaSource.on("audioinfo",function(a){return c.trigger(a)}),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_.bind(this));var n={hls:this.hls_,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),withCredentials:this.withCredentials,seekable:function(){return c.seekable()},seeking:function(){return c.tech_.seeking()},setCurrentTime:function(b){return c.setCurrentTime(b)},hasPlayed:function(){return 0!==c.tech_.played().length},bandwidth:j};if(this.mainSegmentLoader_=new m.default(n),this.audioSegmentLoader_=new m.default(n),!d)throw new Error("A non-empty playlist URL is required");this.masterPlaylistLoader_=new k.default(d,this.hls_,this.withCredentials),this.masterPlaylistLoader_.on("loadedmetadata",function(){var a=c.masterPlaylistLoader_.media();a.endList&&"none"!==c.tech_.preload()&&(c.mainSegmentLoader_.playlist(a),c.mainSegmentLoader_.expired(c.masterPlaylistLoader_.expired_),c.mainSegmentLoader_.load()),c.setupSourceBuffer_(),c.setupFirstPlay(),c.useAudio()}),this.masterPlaylistLoader_.on("loadedplaylist",function(){var a=c.masterPlaylistLoader_.media(),b=void 0;if(!a)return c.initialMedia_=c.selectPlaylist(),c.masterPlaylistLoader_.media(c.initialMedia_),c.fillAudioTracks_(),void c.trigger("selectedinitialmedia");c.mainSegmentLoader_.playlist(a),c.mainSegmentLoader_.expired(c.masterPlaylistLoader_.expired_),c.updateDuration(),b=c.seekable(),a.endList||0===b.length||c.mediaSource.addSeekableRange_(b.start(0),b.end(0))}),this.masterPlaylistLoader_.on("error",function(){c.blacklistCurrentPlaylist(c.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){c.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){c.mainSegmentLoader_.abort(),c.mainSegmentLoader_.load(),c.tech_.trigger({type:"mediachange",bubbles:!0})}),this.mainSegmentLoader_.on("progress",function(){c.masterPlaylistLoader_.media(c.selectPlaylist()),c.trigger("progress")}),this.mainSegmentLoader_.on("error",function(){c.blacklistCurrentPlaylist(c.mainSegmentLoader_.error())}),this.audioSegmentLoader_.on("error",function(){q.default.log.warn("Problem encountered with the current alternate audio track. Switching back to default."),c.audioSegmentLoader_.abort(),c.audioPlaylistLoader_=null,c.useAudio()}),this.masterPlaylistLoader_.load()}return i(b,a),e(b,[{key:"fillAudioTracks_",value:function(){var b=this.master(),c=b.mediaGroups||{};c&&c.AUDIO&&0!==Object.keys(c.AUDIO).length&&"html5"===this.mode_||(c.AUDIO={main:{default:{default:!0}}});var d={};for(var e in c.AUDIO)for(var f in c.AUDIO[e]){var g=c.AUDIO[e][f];if(d[f])d[f].addLoader(e,g.resolvedUri);else{var h=new s.default(q.default.mergeOptions(g,{hls:this.hls_,withCredentials:this.withCredential,mediaGroup:e,label:f}));d[f]=h,this.audioTracks_.push(h)}}}},{key:"load",value:function(){this.mainSegmentLoader_.load(),this.audioPlaylistLoader_&&this.audioSegmentLoader_.load()}},{key:"activeAudioGroup",value:function(){var b=this.masterPlaylistLoader_.media(),c="main";return b&&b.attributes&&b.attributes.AUDIO&&(c=b.attributes.AUDIO),c}},{key:"useAudio",value:function(){var b=this,c=void 0;if(this.audioTracks_.forEach(function(a){!c&&a.enabled&&(c=a)}),c){this.audioPlaylistLoader_&&(this.audioPlaylistLoader_.pause(),this.audioPlaylistLoader_=null,this.audioSegmentLoader_.pause());var d=c.getLoader(this.activeAudioGroup());if(!d)return void this.mainSegmentLoader_.clearBuffer();if(this.audioPlaylistLoader_=d,this.audioPlaylistLoader_.started)return this.audioPlaylistLoader_.load(),this.audioSegmentLoader_.load(),void this.audioSegmentLoader_.clearBuffer();this.audioPlaylistLoader_.on("loadedmetadata",function(){var a=b.audioPlaylistLoader_.media();b.audioSegmentLoader_.playlist(a),b.addMimeType_(b.audioSegmentLoader_,"mp4a.40.2",a),(!b.tech_.paused()||a.endList&&"none"!==b.tech_.preload())&&b.audioSegmentLoader_.load(),a.endList||b.audioPlaylistLoader_.trigger("firstplay")}),this.audioPlaylistLoader_.on("loadedplaylist",function(){var a=void 0;if(b.audioPlaylistLoader_&&(a=b.audioPlaylistLoader_.media()),!a)return void b.audioPlaylistLoader_.media(b.audioPlaylistLoader_.playlists.master.playlists[0]);b.audioSegmentLoader_.playlist(a)}),this.audioPlaylistLoader_.on("error",function(){q.default.log.warn("Problem encountered loading the alternate audio track. Switching back to default."),b.audioSegmentLoader_.abort(),b.audioPlaylistLoader_=null,b.useAudio()}),this.audioSegmentLoader_.clearBuffer(),this.audioPlaylistLoader_.start()}}},{key:"fastQualityChange_",value:function(){var b=this.selectPlaylist();b!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(b),this.mainSegmentLoader_.sourceUpdater_.remove(this.tech_.currentTime()+5,1/0))}},{key:"play",value:function(){if(!this.setupFirstPlay())return this.tech_.ended()&&this.tech_.setCurrentTime(0),this.load(),this.tech_.duration()===1/0&&this.tech_.currentTime()<this.tech_.seekable().start(0)?this.tech_.setCurrentTime(this.tech_.seekable().start(0)):void 0}},{key:"setupFirstPlay",value:function(){var b=void 0,c=this.masterPlaylistLoader_.media();return!(!c||c.endList||this.tech_.paused()||this.hasPlayed_)&&(this.load(),this.masterPlaylistLoader_.trigger("firstplay"),this.hasPlayed_=!0,b=this.seekable(),b.length&&this.tech_.setCurrentTime(b.end(0)),!0)}},{key:"handleSourceOpen_",value:function(){this.setupSourceBuffer_(),this.tech_.autoplay()&&this.tech_.play(),this.trigger("sourceopen")}},{key:"blacklistCurrentPlaylist",value:function(){var b=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],c=void 0,d=void 0;return(c=b.playlist||this.masterPlaylistLoader_.media())?(c.excludeUntil=Date.now()+t,(d=this.selectPlaylist())?(q.default.log.warn("Problem encountered with the current HLS playlist. Switching to another playlist."),this.masterPlaylistLoader_.media(d)):(q.default.log.warn("Problem encountered with the current HLS playlist. No suitable alternatives found."),this.error=b,this.mediaSource.endOfStream("network"))):(this.error=b,this.mediaSource.endOfStream("network"))}},{key:"pauseLoading",value:function(){this.mainSegmentLoader_.pause(),this.audioPlaylistLoader_&&this.audioSegmentLoader_.pause()}},{key:"setCurrentTime",value:function(b){var c=o.default.findRange(this.tech_.buffered(),b);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?c&&c.length?b:(this.mainSegmentLoader_.abort(),this.audioPlaylistLoader_&&this.audioSegmentLoader_.abort(),void(this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioPlaylistLoader_&&this.audioSegmentLoader_.load()))):0}},{key:"duration",value:function(){return this.masterPlaylistLoader_?this.mediaSource?this.mediaSource.duration:u.Playlist.duration(this.masterPlaylistLoader_.media()):0}},{key:"seekable",value:function(){var b=void 0,c=void 0,d=void 0;return this.masterPlaylistLoader_&&(b=this.masterPlaylistLoader_.media())?(c=u.Playlist.seekable(b,this.masterPlaylistLoader_.expired_),0===c.length?c:this.audioPlaylistLoader_&&(d=u.Playlist.seekable(this.audioPlaylistLoader_.media(),this.audioPlaylistLoader_.expired_),0===d.length)?d:d?q.default.createTimeRanges([[d.start(0)>c.start(0)?d.start(0):c.start(0),d.end(0)<c.end(0)?d.end(0):c.end(0)]]):c):q.default.createTimeRanges()}},{key:"updateDuration",value:function(){var b=this,c=this.mediaSource.duration,d=u.Playlist.duration(this.masterPlaylistLoader_.media()),e=this.tech_.buffered(),f=function a(){b.mediaSource.duration=d,b.tech_.trigger("durationchange"),b.mediaSource.removeEventListener("sourceopen",a)};e.length>0&&(d=Math.max(d,e.end(e.length-1))),c!==d&&("open"!==this.mediaSource.readyState?this.mediaSource.addEventListener("sourceopen",f):f())}},{key:"dispose",value:function(){this.masterPlaylistLoader_.dispose(),this.audioTracks_.forEach(function(a){a.dispose()}),this.audioTracks_.length=0,this.mainSegmentLoader_.dispose(),this.audioSegmentLoader_.dispose()}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffer_",value:function(){var b=this.masterPlaylistLoader_.media();b&&"open"===this.mediaSource.readyState&&(this.addMimeType_(this.mainSegmentLoader_,"avc1.4d400d, mp4a.40.2",b),this.excludeIncompatibleVariants_(b))}},{key:"addMimeType_",value:function(b,c,d){var e="video/mp2t";d.attributes&&d.attributes.CODECS?e+='; codecs="'+d.attributes.CODECS+'"':e+='; codecs="'+c+'"',b.mimeType(e)}},{key:"excludeIncompatibleVariants_",value:function(b){var c=this.masterPlaylistLoader_.master,d=2,e=null,f=null,g=void 0;b.attributes&&b.attributes.CODECS&&(g=v(b.attributes.CODECS),e=g.videoCodec,f=g.audioProfile,d=g.codecCount),c.playlists.forEach(function(a){var b={codecCount:2,videoCodec:null,audioProfile:null};a.attributes&&a.attributes.CODECS&&(b=v(a.attributes.CODECS)),b.codecCount!==d&&(a.excludeUntil=1/0),b.videoCodec!==e&&(a.excludeUntil=1/0),("5"===b.audioProfile&&"5"!==f||"5"===f&&"5"!==b.audioProfile)&&(a.excludeUntil=1/0)})}}]),b}(q.default.EventTarget);c.default=w,b.exports=c.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./hls-audio-track":6,"./playlist-loader":12,"./ranges":14,"./segment-loader":16}],12:[function(a,b,c){(function(d){"use strict";function e(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var f=a("./resolve-url"),g=e(f),h="undefined"!=typeof window?window.videojs:void 0!==d?d.videojs:null,i=a("./stream"),j=e(i),k=a("./m3u8"),l=e(k),m=function(b,c,d){var e=c.slice(),f=void 0,g=void 0;for(d=d||0,f=Math.min(b.length,c.length+d),g=d;g<f;g++)e[g-d]=(0,h.mergeOptions)(b[g],e[g-d]);return e},n=function(b,c){for(var d=!1,e=(0,h.mergeOptions)(b,{}),f=b.playlists.length,i=void 0,j=void 0,k=void 0;f--;)if(i=e.playlists[f],i.uri===c.uri){if(i.segments&&c.segments&&i.segments.length===c.segments.length&&i.mediaSequence===c.mediaSequence)continue;for(e.playlists[f]=(0,h.mergeOptions)(i,c),e.playlists[c.uri]=e.playlists[f],i.segments&&(e.playlists[f].segments=m(i.segments,c.segments,c.mediaSequence-i.mediaSequence)),k=0,e.playlists[f].segments&&(k=e.playlists[f].segments.length);k--;)j=e.playlists[f].segments[k],j.resolvedUri||(j.resolvedUri=(0,g.default)(i.resolvedUri,j.uri)),j.key&&!j.key.resolvedUri&&(j.key.resolvedUri=(0,g.default)(i.resolvedUri,j.key.uri));d=!0}return d?e:null},o=function a(b,c,d){var e=this,f=this,h=void 0,i=void 0,j=void 0,k=void 0,m=void 0;if(a.prototype.constructor.call(this),this.hls_=c,this.trackExpiredTime_=!1,!b)throw new Error("A non-empty playlist URL is required");k=function(a,b,c){f.setBandwidth(j||a),j=null,c&&(f.state=c),f.error={playlist:f.master.playlists[b],status:a.status,message:"HLS playlist request error at URL: "+b,responseText:a.responseText,code:a.status>=500?4:2},f.trigger("error")},m=function(a,b){var c=void 0,d=void 0,e=void 0;f.setBandwidth(j||a),j=null,f.state="HAVE_METADATA",c=new l.default.Parser,c.push(a.responseText),c.end(),c.manifest.uri=b,e=n(f.master,c.manifest),d=1e3*(c.manifest.targetDuration||10),e?(f.master=e,f.updateMediaPlaylist_(c.manifest)):d/=2,f.media().endList||(window.clearTimeout(i),i=window.setTimeout(function(){f.trigger("mediaupdatetimeout")},d)),f.trigger("loadedplaylist")},f.state="HAVE_NOTHING",this.expired_=0,h=this.dispose,f.dispose=function(){f.stopRequest(),window.clearTimeout(i),h.call(this)},f.stopRequest=function(){if(j){var a=j;j=null,a.onreadystatechange=null,a.abort()}},f.media=function(a){var b=f.state,c=void 0;if(!a)return f.media_;if("HAVE_NOTHING"===f.state)throw new Error("Cannot switch media playlist from "+f.state);if("string"==typeof a){if(!f.master.playlists[a])throw new Error("Unknown playlist URI: "+a);a=f.master.playlists[a]}if(c=!f.media_||a.uri!==f.media_.uri,f.master.playlists[a.uri].endList)return j&&(j.onreadystatechange=null,j.abort(),j=null),f.state="HAVE_METADATA",f.media_=a,void(c&&(f.trigger("mediachanging"),f.trigger("mediachange")));if(c){if(f.state="SWITCHING_MEDIA",j){if((0,g.default)(f.master.uri,a.uri)===j.url)return;j.onreadystatechange=null,j.abort(),j=null}this.media_&&this.trigger("mediachanging"),j=this.hls_.xhr({uri:(0,g.default)(f.master.uri,a.uri),withCredentials:d},function(c,d){if(j){if(c)return k(j,a.uri,b);m(d,a.uri),"HAVE_MASTER"===b?f.trigger("loadedmetadata"):f.trigger("mediachange")}})}},f.setBandwidth=function(a){f.bandwidth=a.bandwidth},f.on("firstplay",function(){this.trackExpiredTime_=!0}),f.on("mediaupdatetimeout",function(){"HAVE_METADATA"===f.state&&(f.state="HAVE_CURRENT_METADATA",j=this.hls_.xhr({uri:(0,g.default)(f.master.uri,f.media().uri),withCredentials:d},function(a,b){if(j)return a?k(j,f.media().uri):void m(j,f.media().uri)}))}),f.pause=function(){f.stopRequest(),window.clearTimeout(i)},f.load=function(){f.started?f.media().endList?f.trigger("loadedplaylist"):f.trigger("mediaupdatetimeout"):f.start()},f.start=function(){f.started=!0,j=e.hls_.xhr({uri:b,withCredentials:d},function(a,c){var d=void 0,e=void 0,h=void 0;if(j){if(j=null,a)return f.error={status:c.status,message:"HLS playlist request error at URL: "+b,responseText:c.responseText,code:2},f.trigger("error");if(d=new l.default.Parser,d.push(c.responseText),d.end(),f.state="HAVE_MASTER",d.manifest.uri=b,d.manifest.playlists){for(f.master=d.manifest,h=f.master.playlists.length;h--;)e=f.master.playlists[h],f.master.playlists[e.uri]=e,e.resolvedUri=(0,g.default)(f.master.uri,e.uri);for(var i in f.master.mediaGroups.AUDIO)for(var k in f.master.mediaGroups.AUDIO[i]){var n=f.master.mediaGroups.AUDIO[i][k];n.uri&&(n.resolvedUri=(0,g.default)(f.master.uri,n.uri))}return f.trigger("loadedplaylist"),void(j||f.media(d.manifest.playlists[0]))}return f.master={uri:window.location.href,playlists:[{uri:b}]},f.master.playlists[b]=f.master.playlists[0],f.master.playlists[0].resolvedUri=b,m(c,b),f.trigger("loadedmetadata")}})}};o.prototype=new j.default,o.prototype.updateMediaPlaylist_=function(a){var b=void 0,c=void 0,d=void 0;if(b=this.media_,this.media_=this.master.playlists[a.uri],b&&this.trackExpiredTime_&&a.uri===b.uri){if(a.segments.length){if(void 0!==a.segments[0].start)return void(this.expired_=a.segments[0].start);if(void 0!==a.segments[0].end)return void(this.expired_=a.segments[0].end-a.segments[0].duration)}for(c=a.mediaSequence-b.mediaSequence-1;c>=0;c--)if(d=b.segments[c]){if(void 0!==d.end)return void(this.expired_=d.end);if(void 0!==d.start)return void(this.expired_=d.start+d.duration);this.expired_+=d.duration}else this.expired_+=b.targetDuration||10}},c.default=o,b.exports=c.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./m3u8":7,"./resolve-url":15,"./stream":18}],13:[function(a,b,c){(function(a){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var b="undefined"!=typeof window?window.videojs:void 0!==a?a.videojs:null,d={UNSAFE_LIVE_SEGMENTS:3},e=function(b,c){var d=0,e=c-b.mediaSequence,f=b.segments[e];if(f){if(void 0!==f.start)return{result:f.start,precise:!0};if(void 0!==f.end)return{result:f.end-f.duration,precise:!0}}for(;e--;){if(f=b.segments[e],void 0!==f.end)return{result:d+f.end,precise:!0};if(d+=f.duration,void 0!==f.start)return{result:d+f.start,precise:!0}}return{result:d,precise:!1}},f=function(b,c){for(var d=0,e=void 0,f=c-b.mediaSequence;f<b.segments.length;f++){if(e=b.segments[f],void 0!==e.start)return{result:e.start-d,precise:!0};if(d+=e.duration,void 0!==e.end)return{result:e.end-d,precise:!0}}return{result:-1,precise:!1}},g=function(b,c,d){var g=void 0,h=void 0;return void 0===c&&(c=b.mediaSequence+b.segments.length),c<b.mediaSequence?0:(g=e(b,c),g.precise?g.result:(h=f(b,c),h.precise?h.result:g.result+d))},h=function(b,c,d){if(!b)return 0;if("number"!=typeof d&&(d=0),void 0===c){if(b.totalDuration)return b.totalDuration;if(!b.endList)return window.Infinity}return g(b,c,d)};c.duration=h;var i=function(c,e){var f=void 0,i=void 0,j=void 0;return"number"!=typeof e&&(e=0),c&&c.segments?c.endList?(0,b.createTimeRange)(0,h(c)):(f=g(c,c.mediaSequence,e),j=Math.max(0,c.segments.length-d.UNSAFE_LIVE_SEGMENTS),i=g(c,c.mediaSequence+j,e),(0,b.createTimeRange)(f,i)):(0,b.createTimeRange)()};c.seekable=i;var j=function(b,c,d){var e=void 0,f=void 0,g=c,h=b.segments.length,i=h-1,j=void 0,k=void 0,l=void 0,m=void 0;if(!b)return 0;if(c<0)return 0;for(d=d||0,e=0;e<h;e++)if(f=b.segments[e],f.end){if(f.end>c){m=f.end,k=e;break}l=f.end,j=e+1}if(j===h)return h;if(void 0!==j){for(c-=l,e=j;e<(k||h);e++)if(f=b.segments[e],(c-=f.duration)<0)return e;return e>=k?j+Math.floor((g-l)/(m-l)*(k-j)):i}if(void 0!==k){for(c=m-c,e=k;e>=0;e--)if(f=b.segments[e],(c-=f.duration)<0)return e;return 0===c?0:-1}if((c-=d)<0)return-1;for(e=0;e<h;e++)if(f=b.segments[e],(c-=f.duration)<0)return e;return i};c.getMediaIndexForTime_=j,d.duration=h,d.seekable=i,d.getMediaIndexForTime_=j,c.default=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],14:[function(a,b,c){(function(a){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e="undefined"!=typeof window?window.videojs:void 0!==a?a.videojs:null,f=d(e),g=1/30,h=function(b,c){var d=[],e=void 0;if(b&&b.length)for(e=0;e<b.length;e++)c(b.start(e),b.end(e))&&d.push([b.start(e),b.end(e)]);return f.default.createTimeRanges(d)},i=function(b,c){return h(b,function(a,b){return a-g<=c&&b+g>=c})},j=function(b,c){return h(b,function(a){return a-g>=c})},k=function(b,c){var d=void 0,e=void 0,f=void 0,g=[],h=[],i=function(b){return b[0]<=f&&b[1]>=f};if(b)for(d=0;d<b.length;d++)e=b.start(d),f=b.end(d),h.push([e,f]);if(c)for(d=0;d<c.length;d++)e=c.start(d),f=c.end(d),h.some(i)||g.push(f);return 1!==g.length?null:g[0]},l=function(b,c){var d=null,e=null,g=0,h=[],i=[];if(!(b&&b.length&&c&&c.length))return f.default.createTimeRange();for(var j=b.length;j--;)h.push({time:b.start(j),type:"start"}),h.push({time:b.end(j),type:"end"});for(j=c.length;j--;)h.push({time:c.start(j),type:"start"}),h.push({time:c.end(j),type:"end"});for(h.sort(function(a,b){return a.time-b.time}),j=0;j<h.length;j++)"start"===h[j].type?2===++g&&(d=h[j].time):"end"===h[j].type&&1===--g&&(e=h[j].time),null!==d&&null!==e&&(i.push([d,e]),d=null,e=null);return f.default.createTimeRanges(i)},m=function(b,c){for(var d=b.end(0)-b.start(0),e=l(b,c),f=0,g=e.length;g--;)f+=e.end(g)-e.start(g);return f/d*100};c.default={findRange:i,findNextRange:j,findSoleUncommonTimeRangesEnd:k,calculateBufferedPercent:m,TIME_FUDGE_FACTOR:g},b.exports=c.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],15:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("global/document"),f=d(e),g=function(b,c){var d=f.default.querySelector("base"),e=f.default.querySelector("head"),g=f.default.createElement("a"),h=d,i=void 0,j=void 0;return d?i=d.href:h=e.appendChild(f.default.createElement("base")),h.href=b,g.href=c,j=g.href,d?d.href=i:e.removeChild(h),j};c.default=g,b.exports=c.default},{"global/document":21}],16:[function(a,b,c){(function(b){"use strict";function f(a){return a&&a.__esModule?a:{default:a}}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(b,c,d){for(var e=!0;e;){var f=b,g=c,h=d;e=!1,null===f&&(f=Function.prototype);var i=Object.getOwnPropertyDescriptor(f,g);if(void 0!==i){if("value"in i)return i.value;var k=i.get;if(void 0===k)return;return k.call(h)}var j=Object.getPrototypeOf(f);if(null===j)return;b=j,c=g,d=h,e=!0,i=j=void 0}},i=a("./ranges"),j=f(i),k=a("./playlist"),l="undefined"!=typeof window?window.videojs:void 0!==b?b.videojs:null,m=f(l),n=a("./source-updater"),o=f(n),p=a("./decrypter"),q=500,r=30;c.GOAL_BUFFER_LENGTH=r;var s=function(b,c,d){if(!b)return!1;var e=b.segments[c],f=b.segments[c-1];return!(!d||!e)&&(e.end=d,f?f.end&&(e.duration=e.end-f.end):e.duration=e.end,!0)},t=function(b,c,d,e){if(!b)return!1;var f=b.segments,g=d===f.length-1,h=e.length&&f[f.length-1].end<=e.end(0);return b.endList&&"open"===c.readyState&&(g||h)},u=function(b){var d=void 0;return d=b.offset+b.length-1,"bytes="+b.offset+"-"+d},v=function(b){var c={};return"byterange"in b&&(c.Range=u(b.byterange)),c},w=function(a){function b(a){g(this,b),e(Object.getPrototypeOf(b.prototype),"constructor",this).call(this);var c=void 0;if(!a)throw new TypeError("Initialization options are required");if("function"!=typeof a.currentTime)throw new TypeError("No currentTime getter specified");if(!a.mediaSource)throw new TypeError("No MediaSource specified");c=m.default.mergeOptions(m.default.options.hls,a),this.state="INIT",this.bandwidth=c.bandwidth,this.roundTrip=NaN,this.bytesReceived=0,this.hasPlayed_=c.hasPlayed,this.currentTime_=c.currentTime,this.seekable_=c.seekable,this.seeking_=c.seeking,this.setCurrentTime_=c.setCurrentTime,this.mediaSource_=c.mediaSource,this.withCredentials_=c.withCredentials,this.checkBufferTimeout_=null,this.error_=void 0,this.expired_=0,this.timeCorrection_=0,this.currentTimeline_=-1,this.xhr_=null,this.pendingSegment_=null,this.sourceUpdater_=null,this.hls_=c.hls}return h(b,a),d(b,[{key:"dispose",value:function(){this.state="DISPOSED",this.abort_(),this.sourceUpdater_&&this.sourceUpdater_.dispose()}},{key:"abort",value:function(){"WAITING"===this.state&&(this.abort_(),this.paused()||(this.state="READY",this.fillBuffer_()))}},{key:"error",value:function(b){return void 0!==b&&(this.error_=b),this.pendingSegment_=null,this.error_}},{key:"load",value:function(){this.monitorBuffer_(),this.playlist_&&(!this.sourceUpdater_||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY",this.fillBuffer_()))}},{key:"playlist",value:function(b){if(this.playlist_=b,this.sourceUpdater_&&b&&"INIT"===this.state&&!this.paused())return this.state="READY",this.fillBuffer_()}},{key:"pause",value:function(){this.checkBufferTimeout_&&(window.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}},{key:"paused",value:function(){return null===this.checkBufferTimeout_}},{key:"expired",value:function(b){this.expired_=b}},{key:"mimeType",value:function(b){if(!this.sourceUpdater_&&(this.sourceUpdater_=new o.default(this.mediaSource_,b),this.clearBuffer(),this.playlist_&&"INIT"===this.state&&!this.paused()))return this.state="READY",this.fillBuffer_()}},{key:"monitorBuffer_",value:function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&window.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=window.setTimeout(this.monitorBuffer_.bind(this),q)}},{key:"getSegmentBufferedPercent_",value:function(b,c,d,e){var f=b.segments[c],g=(0,k.duration)(b,b.mediaSequence+c,this.expired_),h=m.default.createTimeRanges([[Math.max(d,g),g+f.duration]]);return j.default.calculateBufferedPercent(h,e)}},{key:"checkBuffer_",value:function(b,c,d){var e=j.default.findRange(b,d);0===e.length&&0===d&&(e=j.default.findRange(b,d+j.default.TIME_FUDGE_FACTOR));var f=void 0,g=void 0,h=this.sourceUpdater_.timestampOffset(),i=void 0,l=void 0;if(c.segments.length){if(0===e.length)l=(0,k.getMediaIndexForTime_)(c,d+this.timeCorrection_,this.expired_);else{if(g=e.end(0),f=Math.max(0,g-d),!this.hasPlayed_()&&f>=1)return null;if(this.hasPlayed_()&&f>=r)return null;l=(0,k.getMediaIndexForTime_)(c,g+this.timeCorrection_,this.expired_)}if(l<0||l===c.segments.length)return null;i=c.segments[l];var m=(0,k.duration)(c,c.mediaSequence+l,this.expired_);return(i.timeline!==this.currentTimeline_||m<this.sourceUpdater_.timestampOffset())&&(h=m),{uri:i.resolvedUri,mediaIndex:l,playlist:c,bytes:null,encryptedBytes:null,buffered:null,timestampOffset:h,timeline:i.timeline}}}},{key:"abort_",value:function(){this.xhr_&&this.xhr_.abort(),this.pendingSegment_=null}},{key:"fillBuffer_",value:function(){if(!this.sourceUpdater_.updating()){var b=this.checkBuffer_(this.sourceUpdater_.buffered(),this.playlist_,this.currentTime_(),this.timestampOffset_);if(b){if(this.getSegmentBufferedPercent_(this.playlist_,b.mediaIndex,this.currentTime_(),this.sourceUpdater_.buffered())>=90)return this.incrementTimeCorrection_(this.playlist_.targetDuration),void(this.paused()||this.fillBuffer_());this.loadSegment_(b)}}}},{key:"loadSegment_",value:function(b){var c=void 0,d=void 0,e=void 0,f=void 0,g=this.seekable_(),h=this.currentTime_(),i=0;i=g.length&&g.start(0)>0&&g.start(0)<h?g.start(0):h-60,i>0&&this.sourceUpdater_.remove(0,i),c=b.playlist.segments[b.mediaIndex],d=1.5*c.duration*1e3,c.key&&(e=this.hls_.xhr({uri:c.key.resolvedUri,responseType:"arraybuffer",withCredentials:this.withCredentials_,timeout:d},this.handleResponse_.bind(this))),this.pendingSegment_=b,f=this.hls_.xhr({uri:b.uri,responseType:"arraybuffer",withCredentials:this.withCredentials_,timeout:d,headers:v(c)},this.handleResponse_.bind(this)),this.xhr_={keyXhr:e,segmentXhr:f,abort:function(){this.segmentXhr&&(this.segmentXhr.onreadystatechange=null,this.segmentXhr.abort(),this.segmentXhr=null),this.keyXhr&&(this.keyXhr.onreadystatechange=null,this.keyXhr.abort(),this.keyXhr=null)}},this.state="WAITING"}},{key:"handleResponse_",value:function(b,c){var d=void 0,e=void 0,f=void 0,g=void 0;if(this.xhr_&&(c===this.xhr_.segmentXhr||c===this.xhr_.keyXhr)){if(d=this.pendingSegment_,e=d.playlist.segments[d.mediaIndex],c.timedout)return this.abort_(),this.bandwidth=1,this.roundTrip=NaN,this.state="READY",this.trigger("progress");if(!c.aborted&&b)return f=this.xhr_.keyXhr,this.abort_(),this.error({status:c.status,message:c===f?"HLS key request error at URL: "+e.key.uri:"HLS segment request error at URL: "+d.uri,code:2,xhr:c}),this.state="READY",this.pause(),this.trigger("error");if(!c.response)return void this.abort_();if(c===this.xhr_.segmentXhr&&(this.xhr_.segmentXhr=null,this.roundTrip=c.roundTripTime,this.bandwidth=c.bandwidth,this.bytesReceived+=c.bytesReceived||0,e.key?d.encryptedBytes=new Uint8Array(c.response):d.bytes=new Uint8Array(c.response)),c===this.xhr_.keyXhr){if(f=this.xhr_.segmentXhr,this.xhr_.keyXhr=null,16!==c.response.byteLength)return this.abort_(),this.error({status:c.status,message:"Invalid HLS key at URL: "+e.key.uri,code:2,xhr:c}),this.state="READY",this.pause(),this.trigger("error");g=new DataView(c.response),e.key.bytes=new Uint32Array([g.getUint32(0),g.getUint32(4),g.getUint32(8),g.getUint32(12)]),e.key.iv=e.key.iv||new Uint32Array([0,0,0,d.mediaIndex+d.playlist.mediaSequence])}this.xhr_.segmentXhr||this.xhr_.keyXhr||(this.xhr_=null,this.processResponse_())}}},{key:"clearBuffer",value:function(){this.sourceUpdater_&&this.sourceUpdater_.buffered().length&&this.sourceUpdater_.remove(0,1/0)}},{key:"processResponse_",value:function(){var b=void 0,c=void 0;this.state="DECRYPTING",b=this.pendingSegment_,c=b.playlist.segments[b.mediaIndex],c.key?new p.Decrypter(b.encryptedBytes,c.key.bytes,c.key.iv,function(a,c){b.bytes=c,this.handleSegment_()}.bind(this)):this.handleSegment_()}},{key:"handleSegment_",value:function(){var b=void 0;this.state="APPENDING",b=this.pendingSegment_,b.buffered=this.sourceUpdater_.buffered(),this.currentTimeline_=b.timeline,b.timestampOffset!==this.sourceUpdater_.timestampOffset()&&this.sourceUpdater_.timestampOffset(b.timestampOffset),this.sourceUpdater_.appendBuffer(b.bytes,this.handleUpdateEnd_.bind(this))}},{key:"handleUpdateEnd_",value:function(){var b=this.pendingSegment_,c=this.currentTime_();this.pendingSegment_=null,this.updateTimeline_(b),this.trigger("progress");var d=b.mediaIndex;d+=b.playlist.mediaSequence-this.playlist_.mediaSequence;var e=j.default.findRange(this.sourceUpdater_.buffered(),c);t(b.playlist,this.mediaSource_,d,e)&&this.mediaSource_.endOfStream();var g=this.seekable_(),h=j.default.findNextRange(this.sourceUpdater_.buffered(),c);this.seeking_()&&0===e.length&&g.length&&c<g.start(0)&&h.length&&(m.default.log("tried seeking to",c,"but that was too early, retrying at",h.start(0)),this.setCurrentTime_(h.start(0)+j.default.TIME_FUDGE_FACTOR)),this.state="READY",this.paused()||this.fillBuffer_()}},{key:"updateTimeline_",value:function(b){var c=void 0,d=void 0,e=void 0,f=this.playlist_.targetDuration,g=b.playlist,h=b.mediaIndex;h+=g.mediaSequence-this.playlist_.mediaSequence,c=g.segments[h],c&&b&&b.playlist.uri===this.playlist_.uri&&(d=j.default.findSoleUncommonTimeRangesEnd(b.buffered,this.sourceUpdater_.buffered()),e=s(g,h,d),f=c.duration),e?this.timeCorrection_=0:this.incrementTimeCorrection_(f)}},{key:"incrementTimeCorrection_",value:function(b){if(this.timeCorrection_>=5*this.playlist_.targetDuration)return this.timeCorrection_=0,this.pause(),this.trigger("error");this.timeCorrection_+=b}}]),b}(m.default.EventTarget);c.default=w}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./decrypter":5,"./playlist":13,"./ranges":14,"./source-updater":17}],17:[function(a,b,c){(function(a){"use strict";function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g="undefined"!=typeof window?window.videojs:void 0!==a?a.videojs:null,h=e(g),i=function(){function a(b,c){var d=this;f(this,a);var e=function(){d.sourceBuffer_=b.addSourceBuffer(c),d.sourceBuffer_.addEventListener("updateend",function(){var a=d.pendingCallback_;d.pendingCallback_=null,a&&a()}),d.sourceBuffer_.addEventListener("updateend",d.runCallback_.bind(d)),d.runCallback_()};this.callbacks_=[],this.pendingCallback_=null,this.timestampOffset_=0,this.mediaSource=b,"closed"===b.readyState?b.addEventListener("sourceopen",e):e()}return d(a,[{key:"abort",value:function(b){var c=this;this.queueCallback_(function(){c.sourceBuffer_.abort()},b)}},{key:"appendBuffer",value:function(b,c){var d=this;this.queueCallback_(function(){d.sourceBuffer_.appendBuffer(b)},c)}},{key:"buffered",value:function(){return this.sourceBuffer_?this.sourceBuffer_.buffered:h.default.createTimeRanges()}},{key:"duration",value:function(b){var c=this;this.queueCallback_(function(){c.sourceBuffer_.duration=b})}},{key:"remove",value:function(b,c){var d=this;this.queueCallback_(function(){d.sourceBuffer_.remove(b,c)})}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating}},{key:"timestampOffset",value:function(b){var c=this;return void 0!==b&&(this.queueCallback_(function(){c.sourceBuffer_.timestampOffset=b}),this.timestampOffset_=b),this.timestampOffset_}},{key:"queueCallback_",value:function(b,c){this.callbacks_.push([b.bind(this),c]),this.runCallback_()}},{key:"runCallback_",value:function(){var b=void 0;this.sourceBuffer_&&!this.sourceBuffer_.updating&&this.callbacks_.length&&(b=this.callbacks_.shift(),this.pendingCallback_=b[1],b[0]())}},{key:"dispose",value:function(){this.sourceBuffer_&&"open"===this.mediaSource.readyState&&this.sourceBuffer_.abort()}}]),a}();c.default=i,b.exports=c.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],18:[function(a,b,c){"use strict";function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){e(this,a),this.listeners={}}return d(a,[{key:"on",value:function(b,c){this.listeners[b]||(this.listeners[b]=[]),this.listeners[b].push(c)}},{key:"off",value:function(b,c){var d=void 0;return!!this.listeners[b]&&(d=this.listeners[b].indexOf(c),this.listeners[b].splice(d,1),d>-1)}},{key:"trigger",value:function(b){var c=void 0,d=void 0,e=void 0,f=void 0;if(c=this.listeners[b])if(2===arguments.length)for(e=c.length,d=0;d<e;++d)c[d].call(this,arguments[1]);else for(f=Array.prototype.slice.call(arguments,1),e=c.length,d=0;d<e;++d)c[d].apply(this,f)}},{key:"dispose",value:function(){this.listeners={}}},{key:"pipe",value:function(b){this.on("data",function(a){b.push(a)})}}]),a}();c.default=f,b.exports=c.default},{}],19:[function(a,b,c){(function(a){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d="undefined"!=typeof window?window.videojs:void 0!==a?a.videojs:null,e=function(){return function a(b,c){if(b=(0,d.mergeOptions)({timeout:45e3},b),a.beforeRequest&&"function"==typeof a.beforeRequest){var e=a.beforeRequest(b);e&&(b=e)}var f=(0,d.xhr)(b,function(a,b){!a&&f.response&&(f.responseTime=(new Date).getTime(),f.roundTripTime=f.responseTime-f.requestTime,f.bytesReceived=f.response.byteLength||f.response.length,f.bandwidth||(f.bandwidth=Math.floor(f.bytesReceived/f.roundTripTime*8*1e3))),a||f.timedout?f.timedout=f.timedout||"ETIMEDOUT"===a.code:f.timedout=!1,a||200===b.statusCode||206===b.statusCode||0===b.statusCode||(a=new Error("XHR Failed with a response of: "+(f&&(f.response||f.responseText)))),c(a,f)});return f.requestTime=(new Date).getTime(),f}};c.default=e,b.exports=c.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],20:[function(a,b,c){},{}],21:[function(a,b,c){(function(c){var d=void 0!==c?c:"undefined"!=typeof window?window:{},e=a("min-document");if("undefined"!=typeof document)b.exports=document;else{var f=d["__GLOBAL_DOCUMENT_CACHE@4"];f||(f=d["__GLOBAL_DOCUMENT_CACHE@4"]=e),b.exports=f}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"min-document":20}],22:[function(a,b,c){"use strict";var d;b.exports=function(b){var c=d[b.byteLength%16||0],e=new Uint8Array(b.byteLength+c.length);return e.set(b),e.set(c,b.byteLength),e},d=[[16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],[15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],[14,14,14,14,14,14,14,14,14,14,14,14,14,14],[13,13,13,13,13,13,13,13,13,13,13,13,13],[12,12,12,12,12,12,12,12,12,12,12,12],[11,11,11,11,11,11,11,11,11,11,11],[10,10,10,10,10,10,10,10,10,10],[9,9,9,9,9,9,9,9,9],[8,8,8,8,8,8,8,8],[7,7,7,7,7,7,7],[6,6,6,6,6,6],[5,5,5,5,5],[4,4,4,4],[3,3,3],[2,2],[1]]},{}],23:[function(a,b,c){"use strict";c.pad=a("./pad.js"),c.unpad=a("./unpad.js")},{"./pad.js":22,"./unpad.js":24}],24:[function(a,b,c){"use strict";b.exports=function(b){return b.subarray(0,b.byteLength-b[b.byteLength-1])}},{}],25:[function(a,b,c){(function(a){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e="undefined"!=typeof window?window.videojs:void 0!==a?a.videojs:null,f=d(e),g=function(b){Object.defineProperties(b.frame,{id:{get:function(){return f.default.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),b.value.key}},value:{get:function(){return f.default.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),b.value.data}},privateData:{get:function(){return f.default.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),b.value.data}}})},h=function(b,c,d){var e=window.WebKitDataCue||window.VTTCue;c&&c.forEach(function(a){this.inbandTextTrack_.addCue(new e(a.startTime+this.timestampOffset,a.endTime+this.timestampOffset,a.text))},b),d&&d.forEach(function(a){var b=a.cueTime+this.timestampOffset;a.frames.forEach(function(a){var c=new e(b,b,a.value||a.url||a.data||"");c.frame=a,c.value=a,g(c),this.metadataTrack_.addCue(c)},this)},b)};c.default=h,b.exports=c.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],26:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=function(b){return/mp4a\.\d+.\d+/i.test(b)},e=function(b){return/avc1\.[\da-f]+/i.test(b)},f=function(b){var c={type:"",parameters:{}},d=b.trim().split(";");return c.type=d.shift().trim(),d.forEach(function(a){var b=a.trim().split("=");if(b.length>1){var d=b[0].replace(/"/g,"").trim(),e=b[1].replace(/"/g,"").trim();c.parameters[d]=e}}),c};c.default={isAudioCodec:d,parseContentType:f,isVideoCodec:e},b.exports=c.default},{}],27:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=function(b,c,d){d.captions&&d.captions.length&&!b.inbandTextTrack_&&(b.inbandTextTrack_=c.player_.addTextTrack("captions","cc1")),d.metadata&&d.metadata.length&&!b.metadataTrack_&&(b.metadataTrack_=c.player_.addTextTrack("metadata","Timed Metadata"),b.metadataTrack_.inBandMetadataTrackDispatchType=d.metadata.dispatchType)};c.default=d,b.exports=c.default},{}],28:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={TIME_BETWEEN_TICKS:Math.floor(1e3/480),TIME_PER_TICK:Math.floor(1e3/240),BYTES_PER_CHUNK:1024,MIN_CHUNK:1024,MAX_CHUNK:1048576};c.default=d,b.exports=c.default},{}],29:[function(a,b,c){(function(d){"use strict";function g(a){return a&&a.__esModule?a:{default:a}}function h(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function i(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(b,c,d){for(var e=!0;e;){var f=b,g=c,h=d;e=!1,null===f&&(f=Function.prototype);var i=Object.getOwnPropertyDescriptor(f,g);if(void 0!==i){if("value"in i)return i.value;var k=i.get;if(void 0===k)return;return k.call(h)}var j=Object.getPrototypeOf(f);if(null===j)return;b=j,c=g,d=h,e=!0,i=j=void 0}},j="undefined"!=typeof window?window.videojs:void 0!==d?d.videojs:null,k=g(j),l=a("./flash-source-buffer"),m=g(l),n=a("./flash-constants"),o=g(n),p=a("./codec-utils"),q=function(a){function b(){var a=this;h(this,b),f(Object.getPrototypeOf(b.prototype),"constructor",this).call(this),this.sourceBuffers=[],this.readyState="closed",this.on(["sourceopen","webkitsourceopen"],function(b){a.swfObj=document.getElementById(b.swfId),a.player_=(0,k.default)(a.swfObj.parentNode),a.tech_=a.swfObj.tech,a.readyState="open",a.tech_.on("seeking",function(){for(var b=a.sourceBuffers.length;b--;)a.sourceBuffers[b].abort()}),a.swfObj&&a.swfObj.vjs_load()})}return i(b,a),e(b,[{key:"addSeekableRange_",value:function(){}},{key:"addSourceBuffer",value:function(b){var c=(0,p.parseContentType)(b),d=void 0;if("video/mp2t"!==c.type)throw new Error("NotSupportedError (Video.js)");return d=new m.default(this),this.sourceBuffers.push(d),d}},{key:"endOfStream",value:function(b){"network"===b?this.tech_.error(2):"decode"===b&&this.tech_.error(3),"ended"!==this.readyState&&(this.readyState="ended",this.swfObj.vjs_endOfStream())}}]),b}(k.default.EventTarget);c.default=q;try{Object.defineProperty(q.prototype,"duration",{get:function(){return this.swfObj?this.swfObj.vjs_getProperty("duration"):NaN},set:function(b){var c=void 0,d=this.swfObj.vjs_getProperty("duration");if(this.swfObj.vjs_setProperty("duration",b),b<d)for(c=0;c<this.sourceBuffers.length;c++)this.sourceBuffers[c].remove(b,d);return b}})}catch(a){q.prototype.duration=NaN}for(var r in o.default)q[r]=o.default[r];b.exports=c.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./codec-utils":26,"./flash-constants":28,"./flash-source-buffer":30}],30:[function(a,b,c){(function(d){"use strict";function g(a){return a&&a.__esModule?a:{default:a}}function h(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function i(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(b,c,d){for(var e=!0;e;){var f=b,g=c,h=d;e=!1,null===f&&(f=Function.prototype);var i=Object.getOwnPropertyDescriptor(f,g);if(void 0!==i){if("value"in i)return i.value;var k=i.get;if(void 0===k)return;return k.call(h)}var j=Object.getPrototypeOf(f);if(null===j)return;b=j,c=g,d=h,e=!0,i=j=void 0}},j="undefined"!=typeof window?window.videojs:void 0!==d?d.videojs:null,k=g(j),l=a("mux.js"),m=g(l),n=a("./remove-cues-from-track"),o=g(n),p=a("./create-text-tracks-if-necessary"),q=g(p),r=a("./add-text-track-data"),s=g(r),t=a("./flash-constants"),u=g(t),v=function(b){window.setTimeout(b,u.default.TIME_BETWEEN_TICKS)},w=function(b,c){("number"!=typeof c||c<0)&&(c=0);var d=Math.pow(10,c);return Math.round(b*d)/d},x=function(a){function b(a){var c=this;h(this,b),f(Object.getPrototypeOf(b.prototype),"constructor",this).call(this);var d=void 0;this.chunkSize_=u.default.BYTES_PER_CHUNK,this.buffer_=[],this.bufferSize_=0,this.basePtsOffset_=NaN,this.mediaSource=a,this.updating=!1,this.timestampOffset_=0,this.segmentParser_=new m.default.flv.Transmuxer,this.segmentParser_.on("data",this.receiveBuffer_.bind(this)),d=window.btoa(String.fromCharCode.apply(null,Array.prototype.slice.call(this.segmentParser_.getFlvHeader()))),this.mediaSource.swfObj.vjs_appendBuffer(d),Object.defineProperty(this,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(b){"number"==typeof b&&b>=0&&(this.timestampOffset_=b,this.segmentParser_=new m.default.flv.Transmuxer,this.segmentParser_.on("data",this.receiveBuffer_.bind(this)),this.mediaSource.swfObj.vjs_discontinuity(),this.basePtsOffset_=NaN)}}),Object.defineProperty(this,"buffered",{get:function(){if(!(this.mediaSource&&this.mediaSource.swfObj&&"vjs_getProperty"in this.mediaSource.swfObj))return k.default.createTimeRange();var b=this.mediaSource.swfObj.vjs_getProperty("buffered");return b&&b.length&&(b[0][0]=w(b[0][0],3),b[0][1]=w(b[0][1],3)),k.default.createTimeRanges(b)}}),this.mediaSource.player_.on("seeked",function(){(0,o.default)(0,1/0,c.metadataTrack_),(0,o.default)(0,1/0,c.inbandTextTrack_)})}return i(b,a),e(b,[{key:"appendBuffer",value:function(b){var c=this,d=void 0,e=524288,f=0;if(this.updating)throw d=new Error("SourceBuffer.append() cannot be called while an update is in progress"),d.name="InvalidStateError",d.code=11,d;this.updating=!0,this.mediaSource.readyState="open",this.trigger({type:"update"}),function a(){c.segmentParser_.push(b.subarray(f,f+e)),f+=e,v(f<b.byteLength?a:c.segmentParser_.flush.bind(c.segmentParser_))}()}},{key:"abort",value:function(){this.buffer_=[],this.bufferSize_=0,this.mediaSource.swfObj.vjs_abort(),this.updating&&(this.updating=!1,this.trigger({type:"updateend"}))}},{key:"remove",value:function(b,c){(0,o.default)(b,c,this.metadataTrack_),(0,o.default)(b,c,this.inbandTextTrack_),this.trigger({type:"update"}),this.trigger({type:"updateend"})}},{key:"receiveBuffer_",value:function(b){var c=this;(0,q.default)(this,this.mediaSource,b),(0,s.default)(this,b.captions,b.metadata),v(function(){var a=c.convertTagsToData_(b);0===c.buffer_.length&&v(c.processBuffer_.bind(c)),a&&(c.buffer_.push(a),c.bufferSize_+=a.byteLength)})}},{key:"processBuffer_",value:function(){var b=void 0,c=void 0,d=void 0,e=void 0,f=void 0,g=0,h=0,i=+new Date,j=void 0;if(!this.buffer_.length)return void(!1!==this.updating&&(this.updating=!1,this.trigger({type:"updateend"})));do{for(h++,b=this.buffer_[0].subarray(g,g+this.chunkSize_),b.byteLength<this.chunkSize_||this.buffer_[0].byteLength===g+this.chunkSize_?(g=0,this.buffer_.shift()):g+=this.chunkSize_,this.bufferSize_-=b.byteLength,e="",d=b.byteLength,c=0;c<d;c++)e+=String.fromCharCode(b[c]);f=window.btoa(e),this.mediaSource.swfObj.CallFunction('<invoke name="vjs_appendBuffer"returntype="javascript"><arguments><string>'+f+"</string></arguments></invoke>"),j=new Date-i}while(this.buffer_.length&&j<u.default.TIME_PER_TICK);this.buffer_.length&&g&&(this.buffer_[0]=this.buffer_[0].subarray(g)),j>=u.default.TIME_PER_TICK&&(this.chunkSize_=Math.floor(this.chunkSize_*(h/4))),this.chunkSize_=Math.max(u.default.MIN_CHUNK,Math.min(this.chunkSize_,u.default.MAX_CHUNK)),0!==this.bufferSize_?v(this.processBuffer_.bind(this)):(this.updating=!1,this.trigger({type:"updateend"}))}},{key:"convertTagsToData_",value:function(b){var c=0,d=this.mediaSource.tech_,e=0,f=void 0,g=void 0,h=void 0,i=[],j=this.getOrderedTags_(b);for(isNaN(this.basePtsOffset_)&&j.length&&(this.basePtsOffset_=j[0].pts),d.buffered().length&&(e=d.buffered().end(0)-this.timestampOffset),e=Math.max(e,d.currentTime()-this.timestampOffset),e*=1e3,e+=this.basePtsOffset_,f=0;f<j.length;f++)j[f].pts>=e&&i.push(j[f]);if(0!==i.length){for(f=0;f<i.length;f++)c+=i[f].bytes.byteLength;for(h=new Uint8Array(c),f=0,g=0;f<i.length;f++)h.set(i[f].bytes,g),g+=i[f].bytes.byteLength;return h}}},{key:"getOrderedTags_",value:function(b){for(var c=b.tags.videoTags,d=b.tags.audioTags,e=void 0,f=[];c.length||d.length;)e=c.length?d.length&&d[0].dts<c[0].dts?d.shift():c.shift():d.shift(),f.push(e.finalize());return f}}]),b}(k.default.EventTarget);c.default=x,b.exports=c.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./add-text-track-data":25,"./create-text-tracks-if-necessary":27,"./flash-constants":28,"./remove-cues-from-track":32,"mux.js":43}],31:[function(a,b,c){(function(d){"use strict";function g(a){return a&&a.__esModule?a:{default:a}}function h(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function i(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(b,c,d){for(var e=!0;e;){var f=b,g=c,h=d;e=!1,null===f&&(f=Function.prototype);var i=Object.getOwnPropertyDescriptor(f,g);if(void 0!==i){if("value"in i)return i.value;var k=i.get;if(void 0===k)return;return k.call(h)}var j=Object.getPrototypeOf(f);if(null===j)return;b=j,c=g,d=h,e=!0,i=j=void 0}},j="undefined"!=typeof window?window.videojs:void 0!==d?d.videojs:null,k=g(j),l=a("./virtual-source-buffer"),m=g(l),n=a("./codec-utils"),o=function(b){return b.map(function(a){return a.replace(/avc1\.(\d+)\.(\d+)/i,function(a,b,c){return"avc1."+("00"+Number(b).toString(16)).slice(-2)+"00"+("00"+Number(c).toString(16)).slice(-2)})})},p=function(a){function b(){var a=this;h(this,b),f(Object.getPrototypeOf(b.prototype),"constructor",this).call(this);var c=void 0;this.nativeMediaSource_=new window.MediaSource;for(c in this.nativeMediaSource_)c in b.prototype||"function"!=typeof this.nativeMediaSource_[c]||(this[c]=this.nativeMediaSource_[c].bind(this.nativeMediaSource_));this.duration_=NaN,Object.defineProperty(this,"duration",{get:function(){return this.duration_===1/0?this.duration_:this.nativeMediaSource_.duration},set:function(b){if(this.duration_=b,b!==1/0)return void(this.nativeMediaSource_.duration=b)}}),Object.defineProperty(this,"seekable",{get:function(){return this.duration_===1/0?k.default.createTimeRanges([[0,this.nativeMediaSource_.duration]]):this.nativeMediaSource_.seekable}}),Object.defineProperty(this,"readyState",{get:function(){return this.nativeMediaSource_.readyState}}),Object.defineProperty(this,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}}),this.sourceBuffers=[],this.activeSourceBuffers_=[],this.updateActiveSourceBuffers_=function(){a.activeSourceBuffers_.length=0;for(var b=!1,c=!0,d=0;d<a.player_.audioTracks().length;d++){var e=a.player_.audioTracks()[d];if(e.enabled&&"main"!==e.kind){b=!0,c=!1;break}}a.sourceBuffers.forEach(function(d){if(d.videoCodec_&&d.audioCodec_)d.audioDisabled_=b;else if(d.videoCodec_&&!d.audioCodec_)d.audioDisabled_=!0,c=!1;else if(!d.videoCodec_&&d.audioCodec_&&(d.audioDisabled_=c,c))return;a.activeSourceBuffers_.push(d)})},["sourceopen","sourceclose","sourceended"].forEach(function(a){this.nativeMediaSource_.addEventListener(a,this.trigger.bind(this))},this),this.on("sourceopen",function(b){var c=document.querySelector('[src="'+a.url_+'"]');c&&(a.player_=(0,k.default)(c.parentNode),a.player_.audioTracks&&a.player_.audioTracks()&&(a.player_.audioTracks().on("change",a.updateActiveSourceBuffers_),a.player_.audioTracks().on("addtrack",a.updateActiveSourceBuffers_),a.player_.audioTracks().on("removetrack",a.updateActiveSourceBuffers_)))}),this.on("sourceclose",function(a){this.sourceBuffers.forEach(function(a){a.transmuxer_&&a.transmuxer_.terminate()}),this.sourceBuffers.length=0,this.player_&&this.player_.audioTracks&&this.player_.audioTracks()&&(this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_))})}return i(b,a),e(b,[{key:"addSeekableRange_",value:function(b,c){this.duration!==1/0||(c>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration))&&(this.nativeMediaSource_.duration=c)}},{key:"addSourceBuffer",value:function(b){var c=void 0,d=(0,n.parseContentType)(b);if("video/mp2t"===d.type){var e=[];d.parameters&&d.parameters.codecs&&(e=d.parameters.codecs.split(","),e=o(e),e=e.filter(function(a){return(0,n.isAudioCodec)(a)||(0,n.isVideoCodec)(a)})),0===e.length&&(e=["avc1.4d400d","mp4a.40.2"]),c=new m.default(this,e),0!==this.sourceBuffers.length&&(this.sourceBuffers[0].createRealSourceBuffers_(),c.createRealSourceBuffers_(),this.sourceBuffers[0].audioDisabled_=!0)}else c=this.nativeMediaSource_.addSourceBuffer(b);return this.sourceBuffers.push(c),c}}]),b}(k.default.EventTarget);c.default=p,b.exports=c.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./codec-utils":26,"./virtual-source-buffer":35}],32:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=function(b,c,d){var e=void 0,f=void 0;if(d)for(e=d.cues.length;e--;)f=d.cues[e],f.startTime<=c&&f.endTime>=b&&d.removeCue(f)};c.default=d,b.exports=c.default},{}],33:[function(a,b,c){"use strict";function e(a){return a&&a.__esModule?a:{default:a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("mux.js"),h=e(g),i=function(b){b.on("data",function(a){var b=a.data;a.data=b.buffer,postMessage({action:"data",segment:a,byteOffset:b.byteOffset,byteLength:b.byteLength},[a.data])}),b.captionStream&&b.captionStream.on("data",function(a){postMessage({action:"caption",data:a})}),b.on("done",function(a){postMessage({action:"done"})})},j=function(){function a(b){f(this,a),this.options=b||{},this.init()}return d(a,[{key:"init",value:function(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new h.default.mp4.Transmuxer(this.options),i(this.transmuxer)}},{key:"push",value:function(b){var c=new Uint8Array(b.data,b.byteOffset,b.byteLength);this.transmuxer.push(c)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(b){var c=b.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4*c))}},{key:"flush",value:function(b){this.transmuxer.flush()}}]),a}(),k=function(b){b.onmessage=function(a){if("init"===a.data.action&&a.data.options)return void(this.messageHandlers=new j(a.data.options));this.messageHandlers||(this.messageHandlers=new j),a.data&&a.data.action&&"init"!==a.data.action&&this.messageHandlers[a.data.action]&&this.messageHandlers[a.data.action](a.data)}};c.default=function(a){return new k(a)},b.exports=c.default},{"mux.js":43}],34:[function(a,b,c){(function(b){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("./flash-media-source"),f=d(e),g=a("./html-media-source"),h=d(g),i="undefined"!=typeof window?window.videojs:void 0!==b?b.videojs:null,j=d(i),k=0,l={mode:"auto"};j.default.mediaSources={};var m=function(b,c){var d=j.default.mediaSources[b];if(!d)throw new Error("Media Source not found (Video.js)");d.trigger({type:"sourceopen",swfId:c})},n=function(){return!!window.MediaSource&&!!window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')},o=function(b){var c=j.default.mergeOptions(l,b);return this.MediaSource={open:m,supportsNativeMediaSources:n},"html5"===c.mode||"auto"===c.mode&&n()?new h.default:new f.default};c.MediaSource=o,o.open=m,o.supportsNativeMediaSources=n;var p={createObjectURL:function(b){var d=void 0;return b instanceof h.default?(d=window.URL.createObjectURL(b.nativeMediaSource_),b.url_=d,d):b instanceof f.default?(d="blob:vjs-media-source/"+k,k++,j.default.mediaSources[d]=b,d):(d=window.URL.createObjectURL(b),b.url_=d,d)}};c.URL=p,j.default.MediaSource=o,j.default.URL=p}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./flash-media-source":29,"./html-media-source":31}],35:[function(a,b,c){(function(d){"use strict";function g(a){return a&&a.__esModule?a:{default:a}}function h(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function i(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(b,c,d){for(var e=!0;e;){var f=b,g=c,h=d;e=!1,null===f&&(f=Function.prototype);var i=Object.getOwnPropertyDescriptor(f,g);if(void 0!==i){if("value"in i)return i.value;var k=i.get;if(void 0===k)return;return k.call(h)}var j=Object.getPrototypeOf(f);if(null===j)return;b=j,c=g,d=h,e=!0,i=j=void 0}},j="undefined"!=typeof window?window.videojs:void 0!==d?d.videojs:null,k=g(j),l=a("./create-text-tracks-if-necessary"),m=g(l),n=a("./remove-cues-from-track"),o=g(n),p=a("./add-text-track-data"),q=g(p),r=a("webworkify"),s=g(r),t=a("./transmuxer-worker"),u=g(t),v=a("./codec-utils"),w=function(a){function b(a,c){var d=this;h(this,b),f(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,k.default.EventTarget),this.timestampOffset_=0,this.pendingBuffers_=[],this.bufferUpdating_=!1,this.mediaSource_=a,this.codecs_=c,this.audioCodec_=null,this.videoCodec_=null,this.audioDisabled_=!1;var e={remux:!1};this.codecs_.forEach(function(a){(0,v.isAudioCodec)(a)?d.audioCodec_=a:(0,v.isVideoCodec)(a)&&(d.videoCodec_=a)}),this.transmuxer_=(0,s.default)(u.default),this.transmuxer_.postMessage({action:"init",options:e}),this.transmuxer_.onmessage=function(a){return"data"===a.data.action?d.data_(a):"done"===a.data.action?d.done_(a):void 0},Object.defineProperty(this,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(b){"number"==typeof b&&b>=0&&(this.timestampOffset_=b,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:b}))}}),Object.defineProperty(this,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(b){this.videoBuffer_&&(this.videoBuffer_.appendWindowStart=b),this.audioBuffer_&&(this.audioBuffer_.appendWindowStart=b)}}),Object.defineProperty(this,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}}),Object.defineProperty(this,"buffered",{get:function(){var b=null,c=null,d=0,e=[],f=[];if(!this.videoBuffer_&&(this.audioDisabled_||!this.audioBuffer_))return k.default.createTimeRange();if(!this.videoBuffer_)return this.audioBuffer_.buffered;if(this.audioDisabled_||!this.audioBuffer_)return this.videoBuffer_.buffered;if(!(this.videoBuffer_&&0!==this.videoBuffer_.buffered.length||this.audioBuffer_&&0!==this.audioBuffer_.buffered.length))return k.default.createTimeRange();for(var g=this.videoBuffer_.buffered,h=this.audioBuffer_.buffered,i=g.length;i--;)e.push({time:g.start(i),type:"start"}),e.push({time:g.end(i),type:"end"});for(i=h.length;i--;)e.push({time:h.start(i),type:"start"}),e.push({time:h.end(i),type:"end"});for(e.sort(function(a,b){return a.time-b.time}),i=0;i<e.length;i++)"start"===e[i].type?2===++d&&(b=e[i].time):"end"===e[i].type&&1===--d&&(c=e[i].time),null!==b&&null!==c&&(f.push([b,c]),b=null,c=null);return k.default.createTimeRanges(f)}})}return i(b,a),e(b,[{key:"data_",value:function(b){var c=b.data.segment;c.data=new Uint8Array(c.data,b.data.byteOffset,b.data.byteLength),(0,m.default)(this,this.mediaSource_,c),this.pendingBuffers_.push(c)}},{key:"done_",value:function(b){this.processPendingSegments_()}},{key:"createRealSourceBuffers_",value:function(){var b=this,c=["audio","video"];c.forEach(function(a){if(b[a+"Codec_"]&&!b[a+"Buffer_"]){var d=null;b.mediaSource_[a+"Buffer_"]?d=b.mediaSource_[a+"Buffer_"]:(d=b.mediaSource_.nativeMediaSource_.addSourceBuffer(a+'/mp4;codecs="'+b[a+"Codec_"]+'"'),b.mediaSource_[a+"Buffer_"]=d),b[a+"Buffer_"]=d,["update","updatestart","updateend"].forEach(function(e){d.addEventListener(e,function(){if("audio"!==a||!b.audioDisabled_){return c.every(function(c){return!("audio"!==c||!b.audioDisabled_)||(a===c||!b[c+"Buffer_"]||!b[c+"Buffer_"].updating)})?b.trigger(e):void 0}})})}})}},{key:"appendBuffer",value:function(b){this.bufferUpdating_=!0,this.transmuxer_.postMessage({action:"push",data:b.buffer,byteOffset:b.byteOffset,byteLength:b.byteLength},[b.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"remove",value:function(b,c){this.videoBuffer_&&this.videoBuffer_.remove(b,c),!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.remove(b,c),(0,o.default)(b,c,this.metadataTrack_),(0,o.default)(b,c,this.inbandTextTrack_)}},{key:"processPendingSegments_",value:function(){var b={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};b=this.pendingBuffers_.reduce(function(a,b){var c=b.type,d=b.data;return a[c].segments.push(d),a[c].bytes+=d.byteLength,b.captions&&(a.captions=a.captions.concat(b.captions)),b.info&&(a[c].info=b.info),b.metadata&&(a.metadata=a.metadata.concat(b.metadata)),a},b),this.videoBuffer_||this.audioBuffer_||(0===b.video.bytes&&(this.videoCodec_=null),0===b.audio.bytes&&(this.audioCodec_=null),this.createRealSourceBuffers_()),b.audio.info&&this.mediaSource_.trigger({type:"audioinfo",info:b.audio.info}),b.video.info&&this.mediaSource_.trigger({type:"videoinfo",info:b.video.info}),this.videoBuffer_&&(this.concatAndAppendSegments_(b.video,this.videoBuffer_),(0,q.default)(this,b.captions,b.metadata)),!this.audioDisabled_&&this.audioBuffer_&&this.concatAndAppendSegments_(b.audio,this.audioBuffer_),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(b,c){var d=0,e=void 0;b.bytes&&(e=new Uint8Array(b.bytes),b.segments.forEach(function(a){e.set(a,d),d+=a.byteLength}),c.appendBuffer(e))}},{key:"abort",value:function(){this.videoBuffer_&&this.videoBuffer_.abort(),this.audioBuffer_&&this.audioBuffer_.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"reset"}),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}}]),b}(k.default.EventTarget);c.default=w,b.exports=c.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./add-text-track-data":25,"./codec-utils":26,"./create-text-tracks-if-necessary":27,"./remove-cues-from-track":32,"./transmuxer-worker":33,webworkify:56}],36:[function(a,b,c){"use strict";var e,d=a("../utils/stream.js");e=function(){var a=new Uint8Array,c=0;e.prototype.init.call(this),this.setTimestamp=function(a){c=a},this.parseId3TagSize=function(a,b){var c=a[b+6]<<21|a[b+7]<<14|a[b+8]<<7|a[b+9];return(16&a[b+5])>>4?c+20:c+10},this.parseAdtsSize=function(a,b){var c=(224&a[b+5])>>5,d=a[b+4]<<3;return 6144&a[b+3]|d|c},this.push=function(b){var f,g,h,i,d=0,e=0;for(a.length?(i=a.length,a=new Uint8Array(b.byteLength+i),a.set(a.subarray(0,i)),a.set(b,i)):a=b;a.length-e>=3;)if(a[e]!=="I".charCodeAt(0)||a[e+1]!=="D".charCodeAt(0)||a[e+2]!=="3".charCodeAt(0))if(!0&a[e]&&240==(240&a[e+1])){if(a.length-e<7)break;if((d=this.parseAdtsSize(a,e))>a.length)break;h={type:"audio",data:a.subarray(e,e+d),pts:c,dts:c},this.trigger("data",h),e+=d}else e++;else{if(a.length-e<10)break;if((d=this.parseId3TagSize(a,e))>a.length)break;g={type:"timed-metadata",data:a.subarray(e,e+d)},this.trigger("data",g),e+=d}f=a.length-e,a=f>0?a.subarray(e):new Uint8Array}},e.prototype=new d,b.exports=e},{"../utils/stream.js":55}],37:[function(a,b,c){"use strict";var e,d=a("../utils/stream.js"),f=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];e=function(){var b;e.prototype.init.call(this),this.push=function(a){var e,g,h,i,k,l,c=0,d=0;if("audio"===a.type)for(b?(i=b,b=new Uint8Array(i.byteLength+a.data.byteLength),b.set(i),b.set(a.data,i.byteLength)):b=a.data;c+5<b.length;)if(255===b[c]&&240==(246&b[c+1])){if(g=2*(1&~b[c+1]),e=(3&b[c+3])<<11|b[c+4]<<3|(224&b[c+5])>>5,k=1024*(1+(3&b[c+6])),l=9e4*k/f[(60&b[c+2])>>>2],h=c+e,b.byteLength<h)return;if(this.trigger("data",{pts:a.pts+d*l,dts:a.dts+d*l,sampleCount:k,audioobjecttype:1+(b[c+2]>>>6&3),channelcount:(1&b[c+2])<<2|(192&b[c+3])>>>6,samplerate:f[(60&b[c+2])>>>2],samplingfrequencyindex:(60&b[c+2])>>>2,samplesize:16,data:b.subarray(c+7+g,h)}),b.byteLength===h)return void(b=void 0);d++,b=b.subarray(h)}else c++},this.flush=function(){this.trigger("done")}},e.prototype=new d,b.exports=e},{"../utils/stream.js":55}],38:[function(a,b,c){"use strict";var f,g,d=a("../utils/stream.js"),e=a("../utils/exp-golomb.js");g=function(){var b,c,a=0;g.prototype.init.call(this),this.push=function(d){var e;for(c?(e=new Uint8Array(c.byteLength+d.data.byteLength),e.set(c),e.set(d.data,c.byteLength),c=e):c=d.data;a<c.byteLength-3;a++)if(1===c[a+2]){b=a+5;break}for(;b<c.byteLength;)switch(c[b]){case 0:if(0!==c[b-1]){b+=2;break}if(0!==c[b-2]){b++;break}a+3!==b-2&&this.trigger("data",c.subarray(a+3,b-2));do{b++}while(1!==c[b]&&b<c.length);a=b-2,b+=3;break;case 1:if(0!==c[b-1]||0!==c[b-2]){b+=3;break}this.trigger("data",c.subarray(a+3,b-2)),a=b-2,b+=3;break;default:b+=3}c=c.subarray(a),b-=a,a=0},this.flush=function(){c&&c.byteLength>3&&this.trigger("data",c.subarray(a+3)),c=null,a=0,this.trigger("done")}},g.prototype=new d,f=function(){var b,c,d,h,i,j,k,a=new g;f.prototype.init.call(this),b=this,this.push=function(b){"video"===b.type&&(c=b.trackId,d=b.pts,h=b.dts,a.push(b))},a.on("data",function(a){var e={trackId:c,pts:d,dts:h,data:a};switch(31&a[0]){case 5:e.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:e.nalUnitType="sei_rbsp",e.escapedRBSP=i(a.subarray(1));break;case 7:e.nalUnitType="seq_parameter_set_rbsp",e.escapedRBSP=i(a.subarray(1)),e.config=j(e.escapedRBSP);break;case 8:e.nalUnitType="pic_parameter_set_rbsp";break;case 9:e.nalUnitType="access_unit_delimiter_rbsp"}b.trigger("data",e)}),a.on("done",function(){b.trigger("done")}),this.flush=function(){a.flush()},k=function(a,b){var e,f,c=8,d=8;for(e=0;e<a;e++)0!==d&&(f=b.readExpGolomb(),d=(c+f+256)%256),c=0===d?c:d},i=function(a){for(var e,f,b=a.byteLength,c=[],d=1;d<b-2;)0===a[d]&&0===a[d+1]&&3===a[d+2]?(c.push(d+2),d+=2):d++;if(0===c.length)return a;e=b-c.length,f=new Uint8Array(e);var g=0;for(d=0;d<e;g++,d++)g===c[0]&&(g++,c.shift()),f[d]=a[g];return f},j=function(a){var h,i,j,l,m,n,o,p,q,r,s,t,v,b=0,c=0,d=0,f=0,g=1;if(h=new e(a),i=h.readUnsignedByte(),l=h.readUnsignedByte(),j=h.readUnsignedByte(),h.skipUnsignedExpGolomb(),(100===i||110===i||122===i||244===i||44===i||83===i||86===i||118===i||128===i||138===i||139===i||134===i)&&(m=h.readUnsignedExpGolomb(),3===m&&h.skipBits(1),h.skipUnsignedExpGolomb(),h.skipUnsignedExpGolomb(),h.skipBits(1),h.readBoolean()))for(s=3!==m?8:12,v=0;v<s;v++)h.readBoolean()&&(v<6?k(16,h):k(64,h));if(h.skipUnsignedExpGolomb(),0===(n=h.readUnsignedExpGolomb()))h.readUnsignedExpGolomb();else if(1===n)for(h.skipBits(1),h.skipExpGolomb(),h.skipExpGolomb(),o=h.readUnsignedExpGolomb(),v=0;v<o;v++)h.skipExpGolomb();if(h.skipUnsignedExpGolomb(),h.skipBits(1),p=h.readUnsignedExpGolomb(),q=h.readUnsignedExpGolomb(),r=h.readBits(1),0===r&&h.skipBits(1),h.skipBits(1),h.readBoolean()&&(b=h.readUnsignedExpGolomb(),c=h.readUnsignedExpGolomb(),d=h.readUnsignedExpGolomb(),f=h.readUnsignedExpGolomb()),h.readBoolean()&&h.readBoolean()){switch(h.readUnsignedByte()){case 1:t=[1,1];break;case 2:t=[12,11];break;case 3:t=[10,11];break;case 4:t=[16,11];break;case 5:t=[40,33];break;case 6:t=[24,11];break;case 7:t=[20,11];break;case 8:t=[32,11];break;case 9:t=[80,33];break;case 10:t=[18,11];break;case 11:t=[15,11];break;case 12:t=[64,33];break;case 13:t=[160,99];break;case 14:t=[4,3];break;case 15:t=[3,2];break;case 16:t=[2,1];break;case 255:t=[h.readUnsignedByte()<<8|h.readUnsignedByte(),h.readUnsignedByte()<<8|h.readUnsignedByte()]}t&&(g=t[0]/t[1])}return{profileIdc:i,levelIdc:j,profileCompatibility:l,width:Math.ceil((16*(p+1)-2*b-2*c)*g),height:(2-r)*(q+1)*16-2*d-2*f}}},f.prototype=new d,b.exports={H264Stream:f,NalByteStream:g}},{"../utils/exp-golomb.js":54,"../utils/stream.js":55}],39:[function(a,b,c){b.exports={adts:a("./adts"),h264:a("./h264")}},{"./adts":37,"./h264":38}],40:[function(a,b,c){"use strict";var d;d=function(a,b){var j,c=0,e=16384,f=function(a,b){var c,d=a.position+b;d<a.bytes.byteLength||(c=new Uint8Array(2*d),c.set(a.bytes.subarray(0,a.position),0),a.bytes=c,a.view=new DataView(a.bytes.buffer))},g=d.widthBytes||new Uint8Array("width".length),h=d.heightBytes||new Uint8Array("height".length),i=d.videocodecidBytes||new Uint8Array("videocodecid".length);if(!d.widthBytes){for(j=0;j<"width".length;j++)g[j]="width".charCodeAt(j);for(j=0;j<"height".length;j++)h[j]="height".charCodeAt(j);for(j=0;j<"videocodecid".length;j++)i[j]="videocodecid".charCodeAt(j);d.widthBytes=g,d.heightBytes=h,d.videocodecidBytes=i}switch(this.keyFrame=!1,a){case d.VIDEO_TAG:this.length=16,e*=6;break;case d.AUDIO_TAG:this.length=13,this.keyFrame=!0;break;case d.METADATA_TAG:this.length=29,this.keyFrame=!0;break;default:throw"Error Unknown TagType"}this.bytes=new Uint8Array(e),this.view=new DataView(this.bytes.buffer),this.bytes[0]=a,this.position=this.length,this.keyFrame=b,this.pts=0,this.dts=0,this.writeBytes=function(a,b,c){var e,d=b||0;c=c||a.byteLength,e=d+c,f(this,c),this.bytes.set(a.subarray(d,e),this.position),this.position+=c,this.length=Math.max(this.length,this.position)},this.writeByte=function(a){f(this,1),this.bytes[this.position]=a,this.position++,this.length=Math.max(this.length,this.position)},this.writeShort=function(a){f(this,2),this.view.setUint16(this.position,a),this.position+=2,this.length=Math.max(this.length,this.position)},this.negIndex=function(a){return this.bytes[this.length-a]},this.nalUnitSize=function(){return 0===c?0:this.length-(c+4)},this.startNalUnit=function(){if(c>0)throw new Error("Attempted to create new NAL wihout closing the old one");c=this.length,this.length+=4,this.position=this.length},this.endNalUnit=function(a){var b,d;this.length===c+4?this.length-=4:c>0&&(b=c+4,d=this.length-b,this.position=c,this.view.setUint32(this.position,d),this.position=this.length,a&&a.push(this.bytes.subarray(b,b+d))),c=0},this.writeMetaDataDouble=function(a,b){var d;if(f(this,2+a.length+9),this.view.setUint16(this.position,a.length),this.position+=2,"width"===a)this.bytes.set(g,this.position),this.position+=5;else if("height"===a)this.bytes.set(h,this.position),this.position+=6;else if("videocodecid"===a)this.bytes.set(i,this.position),this.position+=12;else for(d=0;d<a.length;d++)this.bytes[this.position]=a.charCodeAt(d),this.position++;this.position++,this.view.setFloat64(this.position,b),this.position+=8,this.length=Math.max(this.length,this.position),++c},this.writeMetaDataBoolean=function(a,b){var d;for(f(this,2),this.view.setUint16(this.position,a.length),this.position+=2,d=0;d<a.length;d++)f(this,1),this.bytes[this.position]=a.charCodeAt(d),this.position++;f(this,2),this.view.setUint8(this.position,1),this.position++,this.view.setUint8(this.position,b?1:0),this.position++,this.length=Math.max(this.length,this.position),++c},this.finalize=function(){var a,e;switch(this.bytes[0]){case d.VIDEO_TAG:this.bytes[11]=7|(this.keyFrame||b?16:32),this.bytes[12]=b?0:1,a=this.pts-this.dts,this.bytes[13]=(16711680&a)>>>16,this.bytes[14]=(65280&a)>>>8,this.bytes[15]=(255&a)>>>0;break;case d.AUDIO_TAG:this.bytes[11]=175,this.bytes[12]=b?0:1;break;case d.METADATA_TAG:this.position=11,this.view.setUint8(this.position,2),this.position++,this.view.setUint16(this.position,10),this.position+=2,this.bytes.set([111,110,77,101,116,97,68,97,116,97],this.position),this.position+=10,this.bytes[this.position]=8,this.position++,this.view.setUint32(this.position,c),this.position=this.length,this.bytes.set([0,0,9],this.position),this.position+=3,this.length=this.position}return e=this.length-11,this.bytes[1]=(16711680&e)>>>16,this.bytes[2]=(65280&e)>>>8,this.bytes[3]=(255&e)>>>0,this.bytes[4]=(16711680&this.dts)>>>16,this.bytes[5]=(65280&this.dts)>>>8,this.bytes[6]=(255&this.dts)>>>0,this.bytes[7]=(4278190080&this.dts)>>>24,this.bytes[8]=0,this.bytes[9]=0,this.bytes[10]=0,f(this,4),this.view.setUint32(this.length,this.length),this.length+=4,this.position+=4,this.bytes=this.bytes.subarray(0,this.length),this.frameTime=d.frameTime(this.bytes),this}},d.AUDIO_TAG=8,d.VIDEO_TAG=9,d.METADATA_TAG=18,d.isAudioFrame=function(a){return d.AUDIO_TAG===a[0]},d.isVideoFrame=function(a){return d.VIDEO_TAG===a[0]},d.isMetaData=function(a){return d.METADATA_TAG===a[0]},d.isKeyFrame=function(a){return d.isVideoFrame(a)?23===a[11]:!!d.isAudioFrame(a)||!!d.isMetaData(a)},d.frameTime=function(a){var b=a[4]<<16;return b|=a[5]<<8,b|=a[6]<<0,b|=a[7]<<24},b.exports=d},{}],41:[function(a,b,c){b.exports={tag:a("./flv-tag"),Transmuxer:a("./transmuxer"),tools:a("../tools/flv-inspector")}},{"../tools/flv-inspector":52,"./flv-tag":40,"./transmuxer":42}],42:[function(a,b,c){"use strict";var j,k,l,m,n,o,p,d=a("../utils/stream.js"),e=a("./flv-tag.js"),f=a("../m2ts/m2ts.js"),g=a("../codecs/adts.js"),h=a("../codecs/h264").H264Stream;n=function(a,b){"number"==typeof b.pts&&(void 0===a.timelineStartInfo.pts?a.timelineStartInfo.pts=b.pts:a.timelineStartInfo.pts=Math.min(a.timelineStartInfo.pts,b.pts)),"number"==typeof b.dts&&(void 0===a.timelineStartInfo.dts?a.timelineStartInfo.dts=b.dts:a.timelineStartInfo.dts=Math.min(a.timelineStartInfo.dts,b.dts))},o=function(a,b){var c=new e(e.METADATA_TAG);return c.dts=b,c.pts=b,c.writeMetaDataDouble("videocodecid",7),c.writeMetaDataDouble("width",a.width),c.writeMetaDataDouble("height",a.height),c},p=function(a,b){var c,d=new e(e.VIDEO_TAG,!0);for(d.dts=b,d.pts=b,d.writeByte(1),d.writeByte(a.profileIdc),d.writeByte(a.profileCompatibility),d.writeByte(a.levelIdc),d.writeByte(255),d.writeByte(225),d.writeShort(a.sps[0].length),d.writeBytes(a.sps[0]),d.writeByte(a.pps.length),c=0;c<a.pps.length;++c)d.writeShort(a.pps[c].length),d.writeBytes(a.pps[c]);return d},l=function(a){var g,b=[];l.prototype.init.call(this),this.push=function(c){n(a,c),a&&void 0===a.channelcount&&(a.audioobjecttype=c.audioobjecttype,a.channelcount=c.channelcount,a.samplerate=c.samplerate,a.samplingfrequencyindex=c.samplingfrequencyindex,a.samplesize=c.samplesize,a.extraData=a.audioobjecttype<<11|a.samplingfrequencyindex<<7|a.channelcount<<3),c.pts=Math.round(c.pts/90),c.dts=Math.round(c.dts/90),b.push(c)},this.flush=function(){var c,d,h,i=[];if(0===b.length)return void this.trigger("done");for(h=-1/0;b.length;)c=b.shift(),(a.extraData!==g||c.pts-h>=1e3)&&(d=new e(e.METADATA_TAG),d.pts=c.pts,d.dts=c.dts,d.writeMetaDataDouble("audiocodecid",10),d.writeMetaDataBoolean("stereo",2===a.channelcount),d.writeMetaDataDouble("audiosamplerate",a.samplerate),d.writeMetaDataDouble("audiosamplesize",16),i.push(d),g=a.extraData,d=new e(e.AUDIO_TAG,!0),d.pts=c.pts,d.dts=c.dts,d.view.setUint16(d.position,a.extraData),d.position+=2,d.length=Math.max(d.length,d.position),i.push(d),h=c.pts),d=new e(e.AUDIO_TAG),d.pts=c.pts,d.dts=c.dts,d.writeBytes(c.data),i.push(d);g=null,this.trigger("data",{track:a,tags:i}),this.trigger("done")}},l.prototype=new d,k=function(a){var f,g,c=[];k.prototype.init.call(this),this.finishFrame=function(b,c){c&&(f&&a&&a.newMetadata&&(c.keyFrame||0===b.length)&&(b.push(o(f,c.pts)),b.push(p(a,c.pts)),a.newMetadata=!1),c.endNalUnit(),b.push(c))},this.push=function(b){n(a,b),b.pts=Math.round(b.pts/90),b.dts=Math.round(b.dts/90),c.push(b)},this.flush=function(){for(var b,d=[];c.length&&"access_unit_delimiter_rbsp"!==c[0].nalUnitType;)c.shift();if(0===c.length)return void this.trigger("done");for(;c.length;)b=c.shift(),"seq_parameter_set_rbsp"===b.nalUnitType?(a.newMetadata=!0,f=b.config,a.width=f.width,a.height=f.height,a.sps=[b.data],a.profileIdc=f.profileIdc,a.levelIdc=f.levelIdc,a.profileCompatibility=f.profileCompatibility,g.endNalUnit()):"pic_parameter_set_rbsp"===b.nalUnitType?(a.newMetadata=!0,a.pps=[b.data],g.endNalUnit()):"access_unit_delimiter_rbsp"===b.nalUnitType?(g&&this.finishFrame(d,g),g=new e(e.VIDEO_TAG),g.pts=b.pts,g.dts=b.dts):("slice_layer_without_partitioning_rbsp_idr"===b.nalUnitType&&(g.keyFrame=!0),g.endNalUnit()),g.startNalUnit(),g.writeBytes(b.data);g&&this.finishFrame(d,g),this.trigger("data",{track:a,tags:d}),this.trigger("done")}},k.prototype=new d,m=function(a){this.numberOfTracks=0,this.metadataStream=a.metadataStream,this.videoTags=[],this.audioTags=[],this.videoTrack=null,this.audioTrack=null,this.pendingCaptions=[],this.pendingMetadata=[],this.pendingTracks=0,m.prototype.init.call(this),this.push=function(a){return a.text?this.pendingCaptions.push(a):a.frames?this.pendingMetadata.push(a):("video"===a.track.type&&(this.videoTrack=a.track,this.videoTags=a.tags,this.pendingTracks++),void("audio"===a.track.type&&(this.audioTrack=a.track,this.audioTags=a.tags,this.pendingTracks++)))}},m.prototype=new d,m.prototype.flush=function(){var a,b,c,d,e={tags:{},captions:[],metadata:[]};if(!(this.pendingTracks<this.numberOfTracks)){for(this.videoTrack?d=this.videoTrack.timelineStartInfo.pts:this.audioTrack&&(d=this.audioTrack.timelineStartInfo.pts),e.tags.videoTags=this.videoTags,e.tags.audioTags=this.audioTags,c=0;c<this.pendingCaptions.length;c++)b=this.pendingCaptions[c],b.startTime=b.startPts-d,b.startTime/=9e4,b.endTime=b.endPts-d,b.endTime/=9e4,e.captions.push(b);for(c=0;c<this.pendingMetadata.length;c++)a=this.pendingMetadata[c],a.cueTime=a.pts-d,a.cueTime/=9e4,e.metadata.push(a);e.metadata.dispatchType=this.metadataStream.dispatchType,this.videoTrack=null,this.audioTrack=null,this.videoTags=[],this.audioTags=[],this.pendingCaptions.length=0,this.pendingMetadata.length=0,this.pendingTracks=0,this.trigger("data",e),this.trigger("done")}},j=function(a){var i,n,o,p,q,r,s,t,u,b=this;j.prototype.init.call(this),a=a||{},this.metadataStream=new f.MetadataStream,a.metadataStream=this.metadataStream,i=new f.TransportPacketStream,n=new f.TransportParseStream,o=new f.ElementaryStream,p=new g,q=new h,u=new m(a),i.pipe(n).pipe(o),o.pipe(q),o.pipe(p),o.pipe(this.metadataStream).pipe(u),t=new f.CaptionStream,q.pipe(t).pipe(u),o.on("data",function(a){var b,c,d;if("metadata"===a.type){for(b=a.tracks.length;b--;)"video"===a.tracks[b].type?c=a.tracks[b]:"audio"===a.tracks[b].type&&(d=a.tracks[b]);c&&!r&&(u.numberOfTracks++,r=new k(c),q.pipe(r).pipe(u)),d&&!s&&(u.numberOfTracks++,s=new l(d),p.pipe(s).pipe(u))}}),this.push=function(a){i.push(a)},this.flush=function(){i.flush()},u.on("data",function(a){b.trigger("data",a)}),u.on("done",function(){b.trigger("done")}),this.getFlvHeader=function(a,b,c){var g,h,i,d=new Uint8Array(9),f=new DataView(d.buffer);return a=a||0,b=void 0===b||b,c=void 0===c||c,f.setUint8(0,70),f.setUint8(1,76),f.setUint8(2,86),f.setUint8(3,1),f.setUint8(4,(b?4:0)|(c?1:0)),f.setUint32(5,d.byteLength),a<=0?(h=new Uint8Array(d.byteLength+4),h.set(d),h.set([0,0,0,0],d.byteLength),h):(g=new e(e.METADATA_TAG),g.pts=g.dts=0,g.writeMetaDataDouble("duration",a),i=g.finalize().length,h=new Uint8Array(d.byteLength+i),h.set(d),h.set(f.byteLength,i),h)}},j.prototype=new d,b.exports=j},{"../codecs/adts.js":37,"../codecs/h264":38,"../m2ts/m2ts.js":46,"../utils/stream.js":55,"./flv-tag.js":40}],43:[function(a,b,c){"use strict";var d={codecs:a("./codecs"),mp4:a("./mp4"),flv:a("./flv"),mp2t:a("./m2ts")};b.exports=d},{"./codecs":39,"./flv":41,"./m2ts":45,"./mp4":49}],44:[function(a,b,c){"use strict";var d=4,e=128,f=a("../utils/stream"),g=function(a){for(var b=0,c={payloadType:-1,payloadSize:0},f=0,g=0;b<a.byteLength&&a[b]!==e;){for(;255===a[b];)f+=255,b++;for(f+=a[b++];255===a[b];)g+=255,b++;if(g+=a[b++],!c.payload&&f===d){c.payloadType=f,c.payloadSize=g,c.payload=a.subarray(b,b+g);break}b+=g,f=0,g=0}return c},h=function(a){return 181!==a.payload[0]?null:49!=(a.payload[1]<<8|a.payload[2])?null:"GA94"!==String.fromCharCode(a.payload[3],a.payload[4],a.payload[5],a.payload[6])?null:3!==a.payload[7]?null:a.payload.subarray(8,a.payload.length-1)},i=function(a,b){var d,e,f,g,c=[];if(!(64&b[0]))return c;for(e=31&b[0],d=0;d<e;d++)f=3*d,g={type:3&b[f+2],pts:a},4&b[f+2]&&(g.ccData=b[f+3]<<8|b[f+4],c.push(g));return c},j=function(){j.prototype.init.call(this),this.captionPackets_=[],this.field1_=new z,this.field1_.on("data",this.trigger.bind(this,"data")),this.field1_.on("done",this.trigger.bind(this,"done"))};j.prototype=new f,j.prototype.push=function(a){var b,c;"sei_rbsp"===a.nalUnitType&&(b=g(a.escapedRBSP),b.payloadType===d&&(c=h(b))&&(this.captionPackets_=this.captionPackets_.concat(i(a.pts,c))))},j.prototype.flush=function(){if(!this.captionPackets_.length)return void this.field1_.flush();this.captionPackets_.sort(function(a,b){return a.pts-b.pts}),this.captionPackets_.forEach(this.field1_.push,this.field1_),this.captionPackets_.length=0,this.field1_.flush()};var k={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608},l=function(a){return null===a?"":(a=k[a]||a,String.fromCharCode(a))},m=0,n=5152,o=5167,p=5157,q=5158,r=5159,t=5165,u=5153,v=5164,w=5166,x=14,y=function(){for(var a=[],b=x+1;b--;)a.push("");return a},z=function(){z.prototype.init.call(this),this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=y(),this.nonDisplayed_=y(),this.lastControlCode_=null,this.push=function(a){if(0===a.type){var b,c,d,e;if((b=32639&a.ccData)===this.lastControlCode_)return void(this.lastControlCode_=null);switch(this.lastControlCode_=4096==(61440&b)?b:null,b){case m:break;case n:this.mode_="popOn";break;case o:this.flushDisplayed(a.pts),c=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=c,this.startPts_=a.pts;break;case p:this.topRow_=x-1,this.mode_="rollUp";break;case q:this.topRow_=x-2,this.mode_="rollUp";break;case r:this.topRow_=x-3,this.mode_="rollUp";break;case t:this.flushDisplayed(a.pts),this.shiftRowsUp_(),this.startPts_=a.pts;break;case u:"popOn"===this.mode_?this.nonDisplayed_[x]=this.nonDisplayed_[x].slice(0,-1):this.displayed_[x]=this.displayed_[x].slice(0,-1);break;case v:this.flushDisplayed(a.pts),this.displayed_=y();break;case w:this.nonDisplayed_=y();break;default:if(d=b>>>8,e=255&b,d>=16&&d<=23&&e>=64&&e<=127&&(16!==d||e<96)&&(d=32,e=null),(17===d||25===d)&&e>=48&&e<=63&&(d=9834,e=""),16==(240&d))return;this[this.mode_](a.pts,d,e)}}}};z.prototype=new f,z.prototype.flushDisplayed=function(a){var b=this.displayed_.map(function(a){return a.trim()}).filter(function(a){return a.length}).join("\n");b.length&&this.trigger("data",{startPts:this.startPts_,endPts:a,text:b})},z.prototype.popOn=function(a,b,c){var d=this.nonDisplayed_[x];d+=l(b),d+=l(c),this.nonDisplayed_[x]=d},z.prototype.rollUp=function(a,b,c){var d=this.displayed_[x];""===d&&(this.flushDisplayed(a),this.startPts_=a),d+=l(b),d+=l(c),this.displayed_[x]=d},z.prototype.shiftRowsUp_=function(){var a;for(a=0;a<this.topRow_;a++)this.displayed_[a]="";for(a=this.topRow_;a<x;a++)this.displayed_[a]=this.displayed_[a+1];this.displayed_[x]=""},b.exports={CaptionStream:j,Cea608Stream:z}},{"../utils/stream":55}],45:[function(a,b,c){b.exports=a("./m2ts")},{"./m2ts":46}],46:[function(a,b,c){"use strict";var h,i,j,d=a("../utils/stream.js"),e=a("./caption-stream"),f=a("./stream-types"),d=a("../utils/stream.js"),g=a("./stream-types.js"),n=188,o=71,h=function(){var a=new Uint8Array(n),b=0;h.prototype.init.call(this),this.push=function(c){var g,e=0,f=n;for(b?(g=new Uint8Array(c.byteLength+b),g.set(a.subarray(0,b)),g.set(c,b),b=0):g=c;f<g.byteLength;)g[e]!==o||g[f]!==o?(e++,f++):(this.trigger("data",g.subarray(e,f)),e+=n,f+=n);e<g.byteLength&&(a.set(g.subarray(e),0),b=g.byteLength-e)},this.flush=function(){b===n&&a[0]===o&&(this.trigger("data",a),b=0),this.trigger("done")}};h.prototype=new d,i=function(){var a,b,c,e;i.prototype.init.call(this),e=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,a=function(a,d){var e=0;d.payloadUnitStartIndicator&&(e+=a[e]+1),"pat"===d.type?b(a.subarray(e),d):c(a.subarray(e),d)},b=function(a,b){b.section_number=a[7],b.last_section_number=a[8],e.pmtPid=(31&a[10])<<8|a[11],b.pmtPid=e.pmtPid},c=function(a,b){var c,d,f,g;if(1&a[5]){for(e.programMapTable={},c=(15&a[1])<<8|a[2],d=3+c-4,f=(15&a[10])<<8|a[11],g=12+f;g<d;)e.programMapTable[(31&a[g+1])<<8|a[g+2]]=a[g],g+=5+((15&a[g+3])<<8|a[g+4]);for(b.programMapTable=e.programMapTable;e.packetsWaitingForPmt.length;)e.processPes_.apply(e,e.packetsWaitingForPmt.shift())}},this.push=function(b){var c={},d=4;c.payloadUnitStartIndicator=!!(64&b[1]),c.pid=31&b[1],c.pid<<=8,c.pid|=b[2],(48&b[3])>>>4>1&&(d+=b[d]+1),0===c.pid?(c.type="pat",a(b.subarray(d),c),this.trigger("data",c)):c.pid===this.pmtPid?(c.type="pmt",a(b.subarray(d),c),this.trigger("data",c)):void 0===this.programMapTable?this.packetsWaitingForPmt.push([b,d,c]):this.processPes_(b,d,c)},this.processPes_=function(a,b,c){c.streamType=this.programMapTable[c.pid],c.type="pes",c.data=a.subarray(b),this.trigger("data",c)}},i.prototype=new d,i.STREAM_TYPES={h264:27,adts:15},j=function(){var h,a={data:[],size:0},b={data:[],size:0},c={data:[],size:0},d=function(a,b){var c;b.dataAlignmentIndicator=0!=(4&a[6]),c=a[7],192&c&&(b.pts=(14&a[9])<<27|(255&a[10])<<20|(254&a[11])<<12|(255&a[12])<<5|(254&a[13])>>>3,b.pts*=4,b.pts+=(6&a[13])>>>1,b.dts=b.pts,64&c&&(b.dts=(14&a[14])<<27|(255&a[15])<<20|(254&a[16])<<12|(255&a[17])<<5|(254&a[18])>>>3,b.dts*=4,b.dts+=(6&a[18])>>>1)),b.data=a.subarray(9+a[8])},e=function(a,b){var g,c=new Uint8Array(a.size),e={type:b},f=0;if(a.data.length){for(e.trackId=a.data[0].pid;a.data.length;)g=a.data.shift(),c.set(g.data,f),f+=g.data.byteLength;d(c,e),a.size=0,h.trigger("data",e)}};j.prototype.init.call(this),h=this,this.push=function(d){({pat:function(){},pes:function(){var h,i;switch(d.streamType){case f.H264_STREAM_TYPE:case g.H264_STREAM_TYPE:h=a,i="video";break;case f.ADTS_STREAM_TYPE:h=b,i="audio";break;case f.METADATA_STREAM_TYPE:h=c,i="timed-metadata";break;default:return}d.payloadUnitStartIndicator&&e(h,i),h.data.push(d),h.size+=d.data.byteLength},pmt:function(){var c,e,a={type:"metadata",tracks:[]},b=d.programMapTable;for(c in b)b.hasOwnProperty(c)&&(e={timelineStartInfo:{baseMediaDecodeTime:0}},e.id=+c,b[c]===g.H264_STREAM_TYPE?(e.codec="avc",e.type="video"):b[c]===g.ADTS_STREAM_TYPE&&(e.codec="adts",e.type="audio"),a.tracks.push(e));h.trigger("data",a)}})[d.type]()},this.flush=function(){e(a,"video"),e(b,"audio"),e(c,"timed-metadata"),this.trigger("done")}},j.prototype=new d;var p={PAT_PID:0,MP2T_PACKET_LENGTH:n,TransportPacketStream:h,TransportParseStream:i,ElementaryStream:j,CaptionStream:e.CaptionStream,Cea608Stream:e.Cea608Stream,MetadataStream:a("./metadata-stream")};for(var q in f)f.hasOwnProperty(q)&&(p[q]=f[q]);b.exports=p},{"../utils/stream.js":55,"./caption-stream":44,"./metadata-stream":47,"./stream-types":48,"./stream-types.js":48}],47:[function(a,b,c){"use strict";var k,d=a("../utils/stream"),e=a("./stream-types"),f=function(a,b,c){var d,e="";for(d=b;d<c;d++)e+="%"+("00"+a[d].toString(16)).slice(-2);return e},g=function(a,b,c){return decodeURIComponent(f(a,b,c))},h=function(a,b,c){return unescape(f(a,b,c))},i=function(a){return a[0]<<21|a[1]<<14|a[2]<<7|a[3]},j={TXXX:function(a){var b;if(3===a.data[0]){for(b=1;b<a.data.length;b++)if(0===a.data[b]){a.description=g(a.data,1,b),a.value=g(a.data,b+1,a.data.length-1);break}a.data=a.value}},WXXX:function(a){var b;if(3===a.data[0])for(b=1;b<a.data.length;b++)if(0===a.data[b]){a.description=g(a.data,1,b),a.url=g(a.data,b+1,a.data.length);break}},PRIV:function(a){var b;for(b=0;b<a.data.length;b++)if(0===a.data[b]){a.owner=h(a.data,0,b);break}a.privateData=a.data.subarray(b+1),a.data=a.privateData}};k=function(a){var g,b={debug:!(!a||!a.debug),descriptor:a&&a.descriptor},c=0,d=[],f=0;if(k.prototype.init.call(this),this.dispatchType=e.METADATA_STREAM_TYPE.toString(16),b.descriptor)for(g=0;g<b.descriptor.length;g++)this.dispatchType+=("00"+b.descriptor[g].toString(16)).slice(-2);this.push=function(a){var e,g,h,k,l,m;if("timed-metadata"===a.type){if(a.dataAlignmentIndicator&&(f=0,d.length=0),0===d.length&&(a.data.length<10||a.data[0]!=="I".charCodeAt(0)||a.data[1]!=="D".charCodeAt(0)||a.data[2]!=="3".charCodeAt(0)))return void(b.debug&&console.log("Skipping unrecognized metadata packet"));if(d.push(a),f+=a.data.byteLength,1===d.length&&(c=i(a.data.subarray(6,10)),c+=10),!(f<c)){for(e={data:new Uint8Array(c),frames:[],pts:d[0].pts,dts:d[0].dts},l=0;l<c;)e.data.set(d[0].data.subarray(0,c-l),l),l+=d[0].data.byteLength,f-=d[0].data.byteLength,d.shift();g=10,64&e.data[5]&&(g+=4,g+=i(e.data.subarray(10,14)),c-=i(e.data.subarray(16,20)));do{if((h=i(e.data.subarray(g+4,g+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if(m=String.fromCharCode(e.data[g],e.data[g+1],e.data[g+2],e.data[g+3]),k={id:m,data:e.data.subarray(g+10,g+h+10)},k.key=k.id,j[k.id]&&(j[k.id](k),"com.apple.streaming.transportStreamTimestamp"===k.owner)){var n=k.data,o=(1&n[3])<<30|n[4]<<22|n[5]<<14|n[6]<<6|n[7]>>>2;o*=4,o+=3&n[7],k.timeStamp=o,this.trigger("timestamp",k)}e.frames.push(k),g+=10,g+=h}while(g<c);this.trigger("data",e)}}}},k.prototype=new d,b.exports=k},{"../utils/stream":55,"./stream-types":48}],48:[function(a,b,c){"use strict";b.exports={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21}},{}],49:[function(a,b,c){b.exports={generator:a("./mp4-generator"),Transmuxer:a("./transmuxer").Transmuxer,AudioSegmentStream:a("./transmuxer").AudioSegmentStream,VideoSegmentStream:a("./transmuxer").VideoSegmentStream,tools:a("../tools/mp4-inspector")}},{"../tools/mp4-inspector":53,"./mp4-generator":50,"./transmuxer":51}],50:[function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N;!function(){var a;if(A={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(a in A)A.hasOwnProperty(a)&&(A[a]=[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)]);B=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),D=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),C=new Uint8Array([0,0,0,1]),E=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),F=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),G={video:E,audio:F},J=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),I=new Uint8Array([0,0,0,0,0,0,0,0]),K=new Uint8Array([0,0,0,0,0,0,0,0]),L=K,M=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),N=K,H=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),d=function(a){var d,e,f,b=[],c=0;for(d=1;d<arguments.length;d++)b.push(arguments[d]);for(d=b.length;d--;)c+=b[d].byteLength;for(e=new Uint8Array(c+8),f=new DataView(e.buffer,e.byteOffset,e.byteLength),f.setUint32(0,e.byteLength),e.set(a,4),d=0,c=8;d<b.length;d++)e.set(b[d],c),c+=b[d].byteLength;return e},e=function(){return d(A.dinf,d(A.dref,J))},f=function(a){return d(A.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,a.audioobjecttype<<3|a.samplingfrequencyindex>>>1,a.samplingfrequencyindex<<7|a.channelcount<<3,6,1,2]))},g=function(){return d(A.ftyp,B,C,B,D)},s=function(a){return d(A.hdlr,G[a])},h=function(a){return d(A.mdat,a)},r=function(a){var b=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,a.duration>>>24&255,a.duration>>>16&255,a.duration>>>8&255,255&a.duration,85,196,0,0]);return a.samplerate&&(b[12]=a.samplerate>>>24&255,b[13]=a.samplerate>>>16&255,b[14]=a.samplerate>>>8&255,b[15]=255&a.samplerate),d(A.mdhd,b)},q=function(a){return d(A.mdia,r(a),s(a.type),j(a))},i=function(a){return d(A.mfhd,new Uint8Array([0,0,0,0,(4278190080&a)>>24,(16711680&a)>>16,(65280&a)>>8,255&a]))},j=function(a){return d(A.minf,"video"===a.type?d(A.vmhd,H):d(A.smhd,I),e(),u(a))},k=function(a,b){for(var c=[],e=b.length;e--;)c[e]=x(b[e]);return d.apply(null,[A.moof,i(a)].concat(c))},l=function(a){for(var b=a.length,c=[];b--;)c[b]=o(a[b]);return d.apply(null,[A.moov,n(4294967295)].concat(c).concat(m(a)))},m=function(a){for(var b=a.length,c=[];b--;)c[b]=y(a[b]);return d.apply(null,[A.mvex].concat(c))},n=function(a){var b=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&a)>>24,(16711680&a)>>16,(65280&a)>>8,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return d(A.mvhd,b)},t=function(a){var e,f,b=a.samples||[],c=new Uint8Array(4+b.length);for(f=0;f<b.length;f++)e=b[f].flags,c[f+4]=e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy;return d(A.sdtp,c)},u=function(a){return d(A.stbl,v(a),d(A.stts,N),d(A.stsc,L),d(A.stsz,M),d(A.stco,K))},function(){var a,b;v=function(c){return d(A.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===c.type?a(c):b(c))},a=function(a){var g,b=a.sps||[],c=a.pps||[],e=[],f=[];for(g=0;g<b.length;g++)e.push((65280&b[g].byteLength)>>>8),e.push(255&b[g].byteLength),e=e.concat(Array.prototype.slice.call(b[g]));for(g=0;g<c.length;g++)f.push((65280&c[g].byteLength)>>>8),f.push(255&c[g].byteLength),f=f.concat(Array.prototype.slice.call(c[g]));return d(A.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&a.width)>>8,255&a.width,(65280&a.height)>>8,255&a.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d(A.avcC,new Uint8Array([1,a.profileIdc,a.profileCompatibility,a.levelIdc,255].concat([b.length]).concat(e).concat([c.length]).concat(f))),d(A.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},b=function(a){return d(A.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&a.channelcount)>>8,255&a.channelcount,(65280&a.samplesize)>>8,255&a.samplesize,0,0,0,0,(65280&a.samplerate)>>8,255&a.samplerate,0,0]),f(a))}}(),p=function(a){var b=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&a.id)>>24,(16711680&a.id)>>16,(65280&a.id)>>8,255&a.id,0,0,0,0,(4278190080&a.duration)>>24,(16711680&a.duration)>>16,(65280&a.duration)>>8,255&a.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&a.width)>>8,255&a.width,0,0,(65280&a.height)>>8,255&a.height,0,0]);return d(A.tkhd,b)},x=function(a){var b,c,e,f,g;return b=d(A.tfhd,new Uint8Array([0,0,0,58,(4278190080&a.id)>>24,(16711680&a.id)>>16,(65280&a.id)>>8,255&a.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),c=d(A.tfdt,new Uint8Array([0,0,0,0,a.baseMediaDecodeTime>>>24&255,a.baseMediaDecodeTime>>>16&255,a.baseMediaDecodeTime>>>8&255,255&a.baseMediaDecodeTime])),g=88,"audio"===a.type?(e=z(a,g),d(A.traf,b,c,e)):(f=t(a),e=z(a,f.length+g),d(A.traf,b,c,e,f))},o=function(a){return a.duration=a.duration||4294967295,d(A.trak,p(a),q(a))},y=function(a){var b=new Uint8Array([0,0,0,0,(4278190080&a.id)>>24,(16711680&a.id)>>16,(65280&a.id)>>8,255&a.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==a.type&&(b[b.length-1]=0),d(A.trex,b)},function(){var a,b,c;c=function(a,b){var c=0,d=0,e=0,f=0;return a.length&&(void 0!==a[0].duration&&(c=1),void 0!==a[0].size&&(d=2),void 0!==a[0].flags&&(e=4),void 0!==a[0].compositionTimeOffset&&(f=8)),[0,0,c|d|e|f,1,(4278190080&a.length)>>>24,(16711680&a.length)>>>16,(65280&a.length)>>>8,255&a.length,(4278190080&b)>>>24,(16711680&b)>>>16,(65280&b)>>>8,255&b]},b=function(a,b){var e,f,g,h;for(f=a.samples||[],b+=20+16*f.length,e=c(f,b),h=0;h<f.length;h++)g=f[h],e=e.concat([(4278190080&g.duration)>>>24,(16711680&g.duration)>>>16,(65280&g.duration)>>>8,255&g.duration,(4278190080&g.size)>>>24,(16711680&g.size)>>>16,(65280&g.size)>>>8,255&g.size,g.flags.isLeading<<2|g.flags.dependsOn,g.flags.isDependedOn<<6|g.flags.hasRedundancy<<4|g.flags.paddingValue<<1|g.flags.isNonSyncSample,61440&g.flags.degradationPriority,15&g.flags.degradationPriority,(4278190080&g.compositionTimeOffset)>>>24,(16711680&g.compositionTimeOffset)>>>16,(65280&g.compositionTimeOffset)>>>8,255&g.compositionTimeOffset]);return d(A.trun,new Uint8Array(e))},a=function(a,b){var e,f,g,h;for(f=a.samples||[],b+=20+8*f.length,e=c(f,b),h=0;h<f.length;h++)g=f[h],e=e.concat([(4278190080&g.duration)>>>24,(16711680&g.duration)>>>16,(65280&g.duration)>>>8,255&g.duration,(4278190080&g.size)>>>24,(16711680&g.size)>>>16,(65280&g.size)>>>8,255&g.size]);return d(A.trun,new Uint8Array(e))},z=function(c,d){return"audio"===c.type?a(c,d):b(c,d)}}(),b.exports={ftyp:g,mdat:h,moof:k,moov:l,initSegment:function(a){var d,b=g(),c=l(a);return d=new Uint8Array(b.byteLength+c.byteLength),d.set(b),d.set(c,b.byteLength),d}}},{}],51:[function(a,b,c){"use strict";var l,m,n,o,p,q,r,s,t,u,v,d=a("../utils/stream.js"),e=a("./mp4-generator.js"),f=a("../m2ts/m2ts.js"),g=a("../codecs/adts.js"),h=a("../codecs/h264").H264Stream,i=a("../aac"),j=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],k=["width","height","profileIdc","levelIdc","profileCompatibility"];p=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0}}},q=function(a){return a[0]==="I".charCodeAt(0)&&a[1]==="D".charCodeAt(0)&&a[2]==="3".charCodeAt(0)},u=function(a,b){var c;if(a.length!==b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0},v=function(a){var b,c,d=0;for(b=0;b<a.length;b++)c=a[b],d+=c.data.byteLength;return d},m=function(a){var b=[],c=0,d=0;m.prototype.init.call(this),this.push=function(c){r(a,c),a&&j.forEach(function(b){a[b]=c[b]}),b.push(c)},this.setEarliestDts=function(b){d=b-a.timelineStartInfo.baseMediaDecodeTime},this.flush=function(){var d,f,g,h;if(0===b.length)return void this.trigger("done","AudioSegmentStream");d=this.trimAdtsFramesByEarliestDts_(b),a.samples=this.generateSampleTable_(d),g=e.mdat(this.concatenateFrameData_(d)),b=[],t(a),f=e.moof(c,[a]),h=new Uint8Array(f.byteLength+g.byteLength),c++,h.set(f),h.set(g,f.byteLength),s(a),this.trigger("data",{track:a,boxes:h}),this.trigger("done","AudioSegmentStream")},this.trimAdtsFramesByEarliestDts_=function(b){return a.minSegmentDts>=d?b:(a.minSegmentDts=1/0,b.filter(function(b){return b.dts>=d&&(a.minSegmentDts=Math.min(a.minSegmentDts,b.dts),a.minSegmentPts=a.minSegmentDts,!0)}))},this.generateSampleTable_=function(a){var b,c,d=[];for(b=0;b<a.length;b++)c=a[b],d.push({size:c.data.byteLength,duration:1024});return d},this.concatenateFrameData_=function(a){var b,c,d=0,e=new Uint8Array(v(a));for(b=0;b<a.length;b++)c=a[b],e.set(c.data,d),d+=c.data.byteLength;return e}},m.prototype=new d,l=function(a){var d,f,b=0,c=[];l.prototype.init.call(this),delete a.minPTS,this.gopCache_=[],this.push=function(b){r(a,b),"seq_parameter_set_rbsp"!==b.nalUnitType||d||(d=b.config,a.sps=[b.data],k.forEach(function(b){a[b]=d[b]},this)),"pic_parameter_set_rbsp"!==b.nalUnitType||f||(f=b.data,a.pps=[b.data]),c.push(b)},this.flush=function(){for(var d,f,g,h,i,j;c.length&&"access_unit_delimiter_rbsp"!==c[0].nalUnitType;)c.shift();if(0===c.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");d=this.groupNalsIntoFrames_(c),g=this.groupFramesIntoGops_(d),g[0][0].keyFrame||(f=this.getGopForFusion_(c[0],a),f?(g.unshift(f),g.byteLength+=f.byteLength,g.nalCount+=f.nalCount,g.pts=f.pts,g.dts=f.dts,g.duration+=f.duration):g=this.extendFirstKeyFrame_(g)),r(a,g),a.samples=this.generateSampleTable_(g),i=e.mdat(this.concatenateNalData_(g)),this.gopCache_.unshift({gop:g.pop(),pps:a.pps,sps:a.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),c=[],t(a),this.trigger("timelineStartInfo",a.timelineStartInfo),h=e.moof(b,[a]),j=new Uint8Array(h.byteLength+i.byteLength),b++,j.set(h),j.set(i,h.byteLength),this.trigger("data",{track:a,boxes:j}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.resetStream_=function(){s(a),d=void 0,f=void 0},this.getGopForFusion_=function(b){var f,g,h,i,j,c=45e3,d=1e4,e=1/0;for(j=0;j<this.gopCache_.length;j++)i=this.gopCache_[j],h=i.gop,a.pps&&u(a.pps[0],i.pps[0])&&a.sps&&u(a.sps[0],i.sps[0])&&(h.dts<a.timelineStartInfo.dts||(f=b.dts-h.dts-h.duration)>=-d&&f<=c&&(!g||e>f)&&(g=i,e=f));return g?g.gop:null},this.extendFirstKeyFrame_=function(a){var d;return a[0][0].keyFrame||(d=a.shift(),a.byteLength-=d.byteLength,a.nalCount-=d.nalCount,a[0][0].dts=d.dts,a[0][0].pts=d.pts,a[0][0].duration+=d.duration),a},this.groupNalsIntoFrames_=function(a){var b,c,f=[],g=[];for(f.byteLength=0,b=0;b<a.length;b++)c=a[b],"access_unit_delimiter_rbsp"===c.nalUnitType?(f.length&&(f.duration=c.dts-f.dts,g.push(f)),f=[c],f.byteLength=c.data.byteLength,f.pts=c.pts,f.dts=c.dts):("slice_layer_without_partitioning_rbsp_idr"===c.nalUnitType&&(f.keyFrame=!0),f.duration=c.dts-f.dts,f.byteLength+=c.data.byteLength,f.push(c));return g.length&&(!f.duration||f.duration<=0)&&(f.duration=g[g.length-1].duration),g.push(f),g},this.groupFramesIntoGops_=function(a){var b,c,d=[],e=[];for(d.byteLength=0,d.nalCount=0,d.duration=0,d.pts=a[0].pts,d.dts=a[0].dts,e.byteLength=0,e.nalCount=0,e.duration=0,e.pts=a[0].pts,e.dts=a[0].dts,b=0;b<a.length;b++)c=a[b],c.keyFrame?(d.length&&(e.push(d),e.byteLength+=d.byteLength,e.nalCount+=d.nalCount,e.duration+=d.duration),d=[c],d.nalCount=c.length,d.byteLength=c.byteLength,d.pts=c.pts,d.dts=c.dts,d.duration=c.duration):(d.duration+=c.duration,d.nalCount+=c.length,d.byteLength+=c.byteLength,d.push(c));return e.length&&d.duration<=0&&(d.duration=e[e.length-1].duration),e.byteLength+=d.byteLength,e.nalCount+=d.nalCount,e.duration+=d.duration,e.push(d),e},this.generateSampleTable_=function(a,b){var c,d,e,f,g,i=b||0,j=[];for(c=0;c<a.length;c++)for(f=a[c],d=0;d<f.length;d++)g=f[d],e=p(),e.dataOffset=i,e.compositionTimeOffset=g.pts-g.dts,e.duration=g.duration,e.size=4*g.length,e.size+=g.byteLength,g.keyFrame&&(e.flags.dependsOn=2),i+=e.size,j.push(e);return j},this.concatenateNalData_=function(a){var b,c,d,e,f,g,h=0,i=a.byteLength,j=a.nalCount,k=i+4*j,l=new Uint8Array(k),m=new DataView(l.buffer);for(b=0;b<a.length;b++)for(e=a[b],c=0;c<e.length;c++)for(f=e[c],d=0;d<f.length;d++)g=f[d],m.setUint32(h,g.data.byteLength),h+=4,l.set(g.data,h),h+=g.data.byteLength;return l}},l.prototype=new d,r=function(a,b){"number"==typeof b.pts&&(void 0===a.timelineStartInfo.pts&&(a.timelineStartInfo.pts=b.pts),void 0===a.minSegmentPts?a.minSegmentPts=b.pts:a.minSegmentPts=Math.min(a.minSegmentPts,b.pts),void 0===a.maxSegmentPts?a.maxSegmentPts=b.pts:a.maxSegmentPts=Math.max(a.maxSegmentPts,b.pts)),"number"==typeof b.dts&&(void 0===a.timelineStartInfo.dts&&(a.timelineStartInfo.dts=b.dts),void 0===a.minSegmentDts?a.minSegmentDts=b.dts:a.minSegmentDts=Math.min(a.minSegmentDts,b.dts),void 0===a.maxSegmentDts?a.maxSegmentDts=b.dts:a.maxSegmentDts=Math.max(a.maxSegmentDts,b.dts))},s=function(a){delete a.minSegmentDts,delete a.maxSegmentDts,delete a.minSegmentPts,delete a.maxSegmentPts},t=function(a){var c,b=9e4,d=a.minSegmentDts-a.timelineStartInfo.dts,e=a.minSegmentPts-a.minSegmentDts;a.baseMediaDecodeTime=a.timelineStartInfo.baseMediaDecodeTime,a.baseMediaDecodeTime+=d,a.baseMediaDecodeTime-=e,a.baseMediaDecodeTime=Math.max(0,a.baseMediaDecodeTime),"audio"===a.type&&(c=a.samplerate/b,a.baseMediaDecodeTime*=c,a.baseMediaDecodeTime=Math.floor(a.baseMediaDecodeTime))},o=function(a,b){this.numberOfTracks=0,this.metadataStream=b,void 0!==a.remux?this.remuxTracks=!!a.remux:this.remuxTracks=!0,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,o.prototype.init.call(this),this.push=function(a){return a.text?this.pendingCaptions.push(a):a.frames?this.pendingMetadata.push(a):(this.pendingTracks.push(a.track),this.pendingBoxes.push(a.boxes),this.pendingBytes+=a.boxes.byteLength,"video"===a.track.type&&(this.videoTrack=a.track),void("audio"===a.track.type&&(this.audioTrack=a.track)))}},o.prototype=new d,o.prototype.flush=function(a){var d,f,g,i,b=0,c={captions:[],metadata:[],info:{}},h=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==a&&"AudioSegmentStream"!==a)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return void(++this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}for(this.videoTrack?(h=this.videoTrack.timelineStartInfo.pts,k.forEach(function(a){c.info[a]=this.videoTrack[a]},this)):this.audioTrack&&(h=this.audioTrack.timelineStartInfo.pts,j.forEach(function(a){c.info[a]=this.audioTrack[a]},this)),1===this.pendingTracks.length?c.type=this.pendingTracks[0].type:c.type="combined",this.emittedTracks+=this.pendingTracks.length,g=e.initSegment(this.pendingTracks),c.data=new Uint8Array(g.byteLength+this.pendingBytes),c.data.set(g),b+=g.byteLength,i=0;i<this.pendingBoxes.length;i++)c.data.set(this.pendingBoxes[i],b),b+=this.pendingBoxes[i].byteLength;for(i=0;i<this.pendingCaptions.length;i++)d=this.pendingCaptions[i],d.startTime=d.startPts-h,d.startTime/=9e4,d.endTime=d.endPts-h,d.endTime/=9e4,c.captions.push(d);for(i=0;i<this.pendingMetadata.length;i++)f=this.pendingMetadata[i],f.cueTime=f.pts-h,f.cueTime/=9e4,c.metadata.push(f);c.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",c),this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},n=function(a){var d,e,b=this,c=!0;n.prototype.init.call(this),a=a||{},this.baseMediaDecodeTime=a.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var c={};this.transmuxPipeline_=c,c.type="aac",c.metadataStream=new f.MetadataStream,c.aacStream=new i,c.adtsStream=new g,c.coalesceStream=new o(a,c.metadataStream),c.headOfPipeline=c.aacStream,c.aacStream.pipe(c.adtsStream),c.aacStream.pipe(c.metadataStream),c.metadataStream.pipe(c.coalesceStream),c.metadataStream.on("timestamp",function(a){c.aacStream.setTimestamp(a.timeStamp)}),c.aacStream.on("data",function(a){"timed-metadata"!==a.type||c.audioSegmentStream||(e=e||{timelineStartInfo:{baseMediaDecodeTime:b.baseMediaDecodeTime},codec:"adts",type:"audio"},c.coalesceStream.numberOfTracks++,c.audioSegmentStream=new m(e),c.adtsStream.pipe(c.audioSegmentStream).pipe(c.coalesceStream))}),c.coalesceStream.on("data",this.trigger.bind(this,"data")),c.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var c={};this.transmuxPipeline_=c,c.type="ts",c.metadataStream=new f.MetadataStream,c.packetStream=new f.TransportPacketStream,c.parseStream=new f.TransportParseStream,c.elementaryStream=new f.ElementaryStream,c.adtsStream=new g,c.h264Stream=new h,c.captionStream=new f.CaptionStream,c.coalesceStream=new o(a,c.metadataStream),c.headOfPipeline=c.packetStream,c.packetStream.pipe(c.parseStream).pipe(c.elementaryStream),c.elementaryStream.pipe(c.h264Stream),c.elementaryStream.pipe(c.adtsStream),c.elementaryStream.pipe(c.metadataStream).pipe(c.coalesceStream),c.h264Stream.pipe(c.captionStream).pipe(c.coalesceStream),c.elementaryStream.on("data",function(a){var f;if("metadata"===a.type){for(f=a.tracks.length;f--;)d||"video"!==a.tracks[f].type?e||"audio"!==a.tracks[f].type||(e=a.tracks[f],e.timelineStartInfo.baseMediaDecodeTime=b.baseMediaDecodeTime):(d=a.tracks[f],d.timelineStartInfo.baseMediaDecodeTime=b.baseMediaDecodeTime);d&&!c.videoSegmentStream&&(c.coalesceStream.numberOfTracks++,c.videoSegmentStream=new l(d),c.videoSegmentStream.on("timelineStartInfo",function(a){e&&(e.timelineStartInfo=a,c.audioSegmentStream.setEarliestDts(a.dts))}),c.h264Stream.pipe(c.videoSegmentStream).pipe(c.coalesceStream)),e&&!c.audioSegmentStream&&(c.coalesceStream.numberOfTracks++,c.audioSegmentStream=new m(e),c.adtsStream.pipe(c.audioSegmentStream).pipe(c.coalesceStream))}}),c.coalesceStream.on("data",this.trigger.bind(this,"data")),c.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(a){var b=this.transmuxPipeline_;this.baseMediaDecodeTime=a,e&&(e.timelineStartInfo.dts=void 0,e.timelineStartInfo.pts=void 0,s(e),e.timelineStartInfo.baseMediaDecodeTime=a),d&&(b.videoSegmentStream&&(b.videoSegmentStream.gopCache_=[]),d.timelineStartInfo.dts=void 0,d.timelineStartInfo.pts=void 0,s(d),d.timelineStartInfo.baseMediaDecodeTime=a)},this.push=function(a){if(c){var b=q(a);b&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():b||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),c=!1}this.transmuxPipeline_.headOfPipeline.push(a)},this.flush=function(){c=!0,this.transmuxPipeline_.headOfPipeline.flush()}},n.prototype=new d,b.exports={Transmuxer:n,VideoSegmentStream:l,AudioSegmentStream:m,AUDIO_PROPERTIES:j,VIDEO_PROPERTIES:k}},{"../aac":36,"../codecs/adts.js":37,"../codecs/h264":38,"../m2ts/m2ts.js":46,"../utils/stream.js":55,"./mp4-generator.js":50}],52:[function(a,b,c){"use strict";var d={8:"audio",9:"video",18:"metadata"},e=function(a){return"0x"+("00"+a.toString(16)).slice(-2).toUpperCase()},f=function(a){for(var c,b=[];a.byteLength>0;){switch(c=0,a.byteLength){default:b.push(e(a[c++]));case 7:b.push(e(a[c++]));case 6:b.push(e(a[c++]));case 5:b.push(e(a[c++]));case 4:b.push(e(a[c++]));case 3:b.push(e(a[c++]));case 2:b.push(e(a[c++]));case 1:b.push(e(a[c++]))}a=a.subarray(c)}return b.join(" ")},g=function(a,b){var c=["AVC Sequence Header","AVC NALU","AVC End-of-Sequence"],e=a[1]&parseInt("01111111",2)<<16|a[2]<<8|a[3];return b=b||{},b.avcPacketType=c[a[0]],b.CompositionTime=a[1]&parseInt("10000000",2)?-e:e,1===a[0]?b.nalUnitTypeRaw=f(a.subarray(4,100)):b.data=f(a.subarray(4)),b},h=function(a,b){var c=["Unknown","Keyframe (for AVC, a seekable frame)","Inter frame (for AVC, a nonseekable frame)","Disposable inter frame (H.263 only)","Generated keyframe (reserved for server use only)","Video info/command frame"],e=a[0]&parseInt("00001111",2);return b=b||{},b.frameType=c[(a[0]&parseInt("11110000",2))>>>4],b.codecID=e,7===e?g(a.subarray(1),b):b},i=function(a,b){var c=["AAC Sequence Header","AAC Raw"];return b=b||{},b.aacPacketType=c[a[0]],b.data=f(a.subarray(1)),b},j=function(a,b){var c=["Linear PCM, platform endian","ADPCM","MP3","Linear PCM, little endian","Nellymoser 16-kHz mono","Nellymoser 8-kHz mono","Nellymoser","G.711 A-law logarithmic PCM","G.711 mu-law logarithmic PCM","reserved","AAC","Speex","MP3 8-Khz","Device-specific sound"],d=["5.5-kHz","11-kHz","22-kHz","44-kHz"],e=(a[0]&parseInt("11110000",2))>>>4;return b=b||{},b.soundFormat=c[e],b.soundRate=d[(a[0]&parseInt("00001100",2))>>>2],b.soundSize=(a[0]&parseInt("00000010",2))>>>1?"16-bit":"8-bit",b.soundType=a[0]&parseInt("00000001",2)?"Stereo":"Mono",10===e?i(a.subarray(1),b):b},k=function(a){return{tagType:d[a[0]],dataSize:a[1]<<16|a[2]<<8|a[3],timestamp:a[7]<<24|a[4]<<16|a[5]<<8|a[6],streamID:a[8]<<16|a[9]<<8|a[10]}},l=function(a){var b=k(a);switch(a[0]){case 8:j(a.subarray(11),b);break;case 9:h(a.subarray(11),b)}return b},m=function(a){var c,e,b=9,d=[];for(b+=4;b<a.byteLength;)c=a[b+1]<<16,c|=a[b+2]<<8,c|=a[b+3],c+=11,e=a.subarray(b,b+c),d.push(l(e)),b+=c+4;return d},n=function(a){return JSON.stringify(a,null,2)};b.exports={inspectTag:l,inspect:m,textify:n}},{}],53:[function(a,b,c){(function(a){"use strict";var c,d,e=function(a){var b="";return b+=String.fromCharCode(a[0]),b+=String.fromCharCode(a[1]),b+=String.fromCharCode(a[2]),b+=String.fromCharCode(a[3])},f=function(a){return new Date(1e3*a-20828448e5)},g=function(a){return{isLeading:(12&a[0])>>>2,dependsOn:3&a[0],isDependedOn:(192&a[1])>>>6,hasRedundancy:(48&a[1])>>>4,paddingValue:(14&a[1])>>>1,isNonSyncSample:1&a[1],degradationPriority:a[2]<<8|a[3]}},h=function(a){var d,e,b=new DataView(a.buffer,a.byteOffset,a.byteLength),c=[];for(d=0;d+4<a.length;d+=e)if(e=b.getUint32(d),d+=4,e<=0)c.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&a[d]){case 1:c.push("slice_layer_without_partitioning_rbsp");break;case 5:c.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:c.push("sei_rbsp");break;case 7:c.push("seq_parameter_set_rbsp");break;case 8:c.push("pic_parameter_set_rbsp");break;case 9:c.push("access_unit_delimiter_rbsp");break;default:c.push("UNKNOWN NAL - "+a[d]&31)}return c},i={avc1:function(a){var b=new DataView(a.buffer,a.byteOffset,a.byteLength);return{dataReferenceIndex:b.getUint16(6),width:b.getUint16(24),height:b.getUint16(26),horizresolution:b.getUint16(28)+b.getUint16(30)/16,vertresolution:b.getUint16(32)+b.getUint16(34)/16,frameCount:b.getUint16(40),depth:b.getUint16(74),config:c(a.subarray(78,a.byteLength))}},avcC:function(a){var e,f,g,h,b=new DataView(a.buffer,a.byteOffset,a.byteLength),c={configurationVersion:a[0],avcProfileIndication:a[1],profileCompatibility:a[2],avcLevelIndication:a[3],lengthSizeMinusOne:3&a[4],sps:[],pps:[]},d=31&a[5];for(g=6,h=0;h<d;h++)f=b.getUint16(g),g+=2,c.sps.push(new Uint8Array(a.subarray(g,g+f))),g+=f;for(e=a[g],g++,h=0;h<e;h++)f=b.getUint16(g),g+=2,c.pps.push(new Uint8Array(a.subarray(g,g+f))),g+=f;return c},btrt:function(a){var b=new DataView(a.buffer,a.byteOffset,a.byteLength);return{bufferSizeDB:b.getUint32(0),maxBitrate:b.getUint32(4),avgBitrate:b.getUint32(8)}},esds:function(a){return{version:a[0],flags:new Uint8Array(a.subarray(1,4)),esId:a[6]<<8|a[7],streamPriority:31&a[8],decoderConfig:{objectProfileIndication:a[11],streamType:a[12]>>>2&63,bufferSize:a[13]<<16|a[14]<<8|a[15],maxBitrate:a[16]<<24|a[17]<<16|a[18]<<8|a[19],avgBitrate:a[20]<<24|a[21]<<16|a[22]<<8|a[23],decoderConfigDescriptor:{tag:a[24],length:a[25],audioObjectType:a[26]>>>3&31,samplingFrequencyIndex:(7&a[26])<<1|a[27]>>>7&1,channelConfiguration:a[27]>>>3&15}}}},ftyp:function(a){for(var b=new DataView(a.buffer,a.byteOffset,a.byteLength),c={majorBrand:e(a.subarray(0,4)),minorVersion:b.getUint32(4),compatibleBrands:[]},d=8;d<a.byteLength;)c.compatibleBrands.push(e(a.subarray(d,d+4))),d+=4;return c},dinf:function(a){return{boxes:c(a)}},dref:function(a){return{version:a[0],flags:new Uint8Array(a.subarray(1,4)),dataReferences:c(a.subarray(8))}},hdlr:function(b){var c=new DataView(b.buffer,b.byteOffset,b.byteLength),f={version:c.getUint8(0),flags:new Uint8Array(b.subarray(1,4)),handlerType:e(b.subarray(8,12)),name:""},g=8;for(g=24;g<b.byteLength;g++){if(0===b[g]){g++;break}f.name+=String.fromCharCode(b[g])}return f.name=decodeURIComponent(a.escape(f.name)),f},mdat:function(a){return{byteLength:a.byteLength,nals:h(a)}},mdhd:function(a){var d,b=new DataView(a.buffer,a.byteOffset,a.byteLength),c=4,e={version:b.getUint8(0),flags:new Uint8Array(a.subarray(1,4)),language:""};return 1===e.version?(c+=4,e.creationTime=f(b.getUint32(c)),c+=8,e.modificationTime=f(b.getUint32(c)),c+=4,e.timescale=b.getUint32(c),c+=8,e.duration=b.getUint32(c)):(e.creationTime=f(b.getUint32(c)),c+=4,e.modificationTime=f(b.getUint32(c)),c+=4,e.timescale=b.getUint32(c),c+=4,e.duration=b.getUint32(c)),c+=4,d=b.getUint16(c),e.language+=String.fromCharCode(96+(d>>10)),e.language+=String.fromCharCode(96+((960&d)>>5)),e.language+=String.fromCharCode(96+(31&d)),e},mdia:function(a){return{boxes:c(a)}},mfhd:function(a){return{version:a[0],flags:new Uint8Array(a.subarray(1,4)),sequenceNumber:a[4]<<24|a[5]<<16|a[6]<<8|a[7]}},minf:function(a){return{boxes:c(a)}},mp4a:function(a){var b=new DataView(a.buffer,a.byteOffset,a.byteLength),d={dataReferenceIndex:b.getUint16(6),channelcount:b.getUint16(16),samplesize:b.getUint16(18),samplerate:b.getUint16(24)+b.getUint16(26)/65536};return a.byteLength>28&&(d.streamDescriptor=c(a.subarray(28))[0]),d},moof:function(a){return{boxes:c(a)}},moov:function(a){return{boxes:c(a)}},mvex:function(a){return{boxes:c(a)}},mvhd:function(a){var b=new DataView(a.buffer,a.byteOffset,a.byteLength),c=4,d={version:b.getUint8(0),flags:new Uint8Array(a.subarray(1,4))};return 1===d.version?(c+=4,d.creationTime=f(b.getUint32(c)),c+=8,d.modificationTime=f(b.getUint32(c)),c+=4,d.timescale=b.getUint32(c),c+=8,d.duration=b.getUint32(c)):(d.creationTime=f(b.getUint32(c)),c+=4,d.modificationTime=f(b.getUint32(c)),c+=4,d.timescale=b.getUint32(c),c+=4,d.duration=b.getUint32(c)),c+=4,d.rate=b.getUint16(c)+b.getUint16(c+2)/16,c+=4,d.volume=b.getUint8(c)+b.getUint8(c+1)/8,c+=2,c+=2,c+=8,d.matrix=new Uint32Array(a.subarray(c,c+36)),c+=36,c+=24,d.nextTrackId=b.getUint32(c),d},pdin:function(a){var b=new DataView(a.buffer,a.byteOffset,a.byteLength);return{version:b.getUint8(0),flags:new Uint8Array(a.subarray(1,4)),rate:b.getUint32(4),initialDelay:b.getUint32(8)}},sdtp:function(a){var c,b={version:a[0],flags:new Uint8Array(a.subarray(1,4)),samples:[]};for(c=4;c<a.byteLength;c++)b.samples.push({dependsOn:(48&a[c])>>4,isDependedOn:(12&a[c])>>2,hasRedundancy:3&a[c]});return b},sidx:function(a){var e,b=new DataView(a.buffer,a.byteOffset,a.byteLength),c={version:a[0],flags:new Uint8Array(a.subarray(1,4)),references:[],referenceId:b.getUint32(4),timescale:b.getUint32(8),earliestPresentationTime:b.getUint32(12),firstOffset:b.getUint32(16)},d=b.getUint16(22);for(e=24;d;e+=12,d--)c.references.push({referenceType:(128&a[e])>>>7,referencedSize:2147483647&b.getUint32(e),subsegmentDuration:b.getUint32(e+4),startsWithSap:!!(128&a[e+8]),sapType:(112&a[e+8])>>>4,sapDeltaTime:268435455&b.getUint32(e+8)});return c},smhd:function(a){return{version:a[0],flags:new Uint8Array(a.subarray(1,4)),balance:a[4]+a[5]/256}},stbl:function(a){return{boxes:c(a)}},stco:function(a){var e,b=new DataView(a.buffer,a.byteOffset,a.byteLength),c={version:a[0],flags:new Uint8Array(a.subarray(1,4)),chunkOffsets:[]},d=b.getUint32(4);for(e=8;d;e+=4,d--)c.chunkOffsets.push(b.getUint32(e));return c},stsc:function(a){var e,b=new DataView(a.buffer,a.byteOffset,a.byteLength),c=b.getUint32(4),d={version:a[0],flags:new Uint8Array(a.subarray(1,4)),sampleToChunks:[]};for(e=8;c;e+=12,c--)d.sampleToChunks.push({firstChunk:b.getUint32(e),samplesPerChunk:b.getUint32(e+4),sampleDescriptionIndex:b.getUint32(e+8)});return d},stsd:function(a){return{version:a[0],flags:new Uint8Array(a.subarray(1,4)),sampleDescriptions:c(a.subarray(8))}},stsz:function(a){var d,b=new DataView(a.buffer,a.byteOffset,a.byteLength),c={version:a[0],flags:new Uint8Array(a.subarray(1,4)),sampleSize:b.getUint32(4),entries:[]};for(d=12;d<a.byteLength;d+=4)c.entries.push(b.getUint32(d));return c},stts:function(a){var e,b=new DataView(a.buffer,a.byteOffset,a.byteLength),c={version:a[0],flags:new Uint8Array(a.subarray(1,4)),timeToSamples:[]},d=b.getUint32(4);for(e=8;d;e+=8,d--)c.timeToSamples.push({sampleCount:b.getUint32(e),sampleDelta:b.getUint32(e+4)});return c},styp:function(a){return i.ftyp(a)},tfdt:function(a){return{version:a[0],flags:new Uint8Array(a.subarray(1,4)),baseMediaDecodeTime:a[4]<<24|a[5]<<16|a[6]<<8|a[7]}},tfhd:function(a){var i,b=new DataView(a.buffer,a.byteOffset,a.byteLength),c={version:a[0],flags:new Uint8Array(a.subarray(1,4)),trackId:b.getUint32(4)},d=1&c.flags[2],e=2&c.flags[2],f=8&c.flags[2],g=16&c.flags[2],h=32&c.flags[2];return i=8,d&&(i+=4,c.baseDataOffset=b.getUint32(12),i+=4),e&&(c.sampleDescriptionIndex=b.getUint32(i),i+=4),f&&(c.defaultSampleDuration=b.getUint32(i),i+=4),g&&(c.defaultSampleSize=b.getUint32(i),i+=4),h&&(c.defaultSampleFlags=b.getUint32(i)),c},tkhd:function(a){var b=new DataView(a.buffer,a.byteOffset,a.byteLength),c=4,d={version:b.getUint8(0),flags:new Uint8Array(a.subarray(1,4))};return 1===d.version?(c+=4,d.creationTime=f(b.getUint32(c)),c+=8,d.modificationTime=f(b.getUint32(c)),c+=4,d.trackId=b.getUint32(c),c+=4,c+=8,d.duration=b.getUint32(c)):(d.creationTime=f(b.getUint32(c)),c+=4,d.modificationTime=f(b.getUint32(c)),c+=4,d.trackId=b.getUint32(c),c+=4,c+=4,d.duration=b.getUint32(c)),c+=4,c+=8,d.layer=b.getUint16(c),c+=2,d.alternateGroup=b.getUint16(c),c+=2,d.volume=b.getUint8(c)+b.getUint8(c+1)/8,c+=2,c+=2,d.matrix=new Uint32Array(a.subarray(c,c+36)),c+=36,d.width=b.getUint16(c)+b.getUint16(c+2)/16,c+=4,d.height=b.getUint16(c)+b.getUint16(c+2)/16,d},traf:function(a){return{boxes:c(a)}},trak:function(a){return{boxes:c(a)}},trex:function(a){var b=new DataView(a.buffer,a.byteOffset,a.byteLength);return{version:a[0],flags:new Uint8Array(a.subarray(1,4)),trackId:b.getUint32(4),defaultSampleDescriptionIndex:b.getUint32(8),defaultSampleDuration:b.getUint32(12),defaultSampleSize:b.getUint32(16),sampleDependsOn:3&a[20],sampleIsDependedOn:(192&a[21])>>6,sampleHasRedundancy:(48&a[21])>>4,samplePaddingValue:(14&a[21])>>1,sampleIsDifferenceSample:!!(1&a[21]),sampleDegradationPriority:b.getUint16(22)}},trun:function(a){var m,b={version:a[0],flags:new Uint8Array(a.subarray(1,4)),samples:[]},c=new DataView(a.buffer,a.byteOffset,a.byteLength),d=1&b.flags[2],e=4&b.flags[2],f=1&b.flags[1],h=2&b.flags[1],i=4&b.flags[1],j=8&b.flags[1],k=c.getUint32(4),l=8;for(d&&(b.dataOffset=c.getUint32(l),l+=4),e&&k&&(m={flags:g(a.subarray(l,l+4))},l+=4,f&&(m.duration=c.getUint32(l),l+=4),h&&(m.size=c.getUint32(l),l+=4),j&&(m.compositionTimeOffset=c.getUint32(l),l+=4),b.samples.push(m),k--);k--;)m={},f&&(m.duration=c.getUint32(l),l+=4),h&&(m.size=c.getUint32(l),l+=4),i&&(m.flags=g(a.subarray(l,l+4)),l+=4),j&&(m.compositionTimeOffset=c.getUint32(l),l+=4),b.samples.push(m);return b},"url ":function(a){return{version:a[0],flags:new Uint8Array(a.subarray(1,4))}},vmhd:function(a){var b=new DataView(a.buffer,a.byteOffset,a.byteLength);return{version:a[0],flags:new Uint8Array(a.subarray(1,4)),graphicsmode:b.getUint16(4),opcolor:new Uint16Array([b.getUint16(6),b.getUint16(8),b.getUint16(10)])}}};c=function(a){for(var d,f,g,h,j,b=0,c=[],k=new ArrayBuffer(a.length),l=new Uint8Array(k),m=0;m<a.length;++m)l[m]=a[m];for(d=new DataView(k);b<a.byteLength;)f=d.getUint32(b),g=e(a.subarray(b+4,b+8)),h=f>1?b+f:a.byteLength,j=(i[g]||function(a){return{data:a}})(a.subarray(b+8,h)),j.size=f,j.type=g,c.push(j),b=h;return c},d=function(a,b){var c;return b=b||0,c=new Array(2*b+1).join(" "),a.map(function(a,e){return c+a.type+"\n"+Object.keys(a).filter(function(a){return"type"!==a&&"boxes"!==a}).map(function(b){var d=c+"  "+b+": ",e=a[b];if(e instanceof Uint8Array||e instanceof Uint32Array){var f=Array.prototype.slice.call(new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).map(function(a){return" "+("00"+a.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return f?1===f.length?d+"<"+f.join("").slice(1)+">":d+"<\n"+f.map(function(a){return c+"  "+a}).join("\n")+"\n"+c+"  >":d+"<>"}return d+JSON.stringify(e,null,2).split("\n").map(function(a,b){return 0===b?a:c+"  "+a}).join("\n")}).join("\n")+(a.boxes?"\n"+d(a.boxes,b+1):"")}).join("\n")},b.exports={inspect:c,textify:d}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],54:[function(a,b,c){"use strict";var d;d=function(a){var b=a.byteLength,c=0,d=0;this.length=function(){return 8*b},this.bitsAvailable=function(){return 8*b+d},this.loadWord=function(){var e=a.byteLength-b,f=new Uint8Array(4),g=Math.min(4,b);if(0===g)throw new Error("no bytes available");f.set(a.subarray(e,e+g)),c=new DataView(f.buffer).getUint32(0),d=8*g,b-=g},this.skipBits=function(a){var e;d>a?(c<<=a,d-=a):(a-=d,e=Math.floor(a/8),a-=8*e,b-=e,this.loadWord(),c<<=a,d-=a)},this.readBits=function(a){var e=Math.min(d,a),f=c>>>32-e;return d-=e,d>0?c<<=e:b>0&&this.loadWord(),e=a-e,e>0?f<<e|this.readBits(e):f},this.skipLeadingZeros=function(){var a;for(a=0;a<d;++a)if(0!=(c&2147483648>>>a))return c<<=a,d-=a,a;return this.loadWord(),a+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var a=this.skipLeadingZeros();return this.readBits(a+1)-1},this.readExpGolomb=function(){var a=this.readUnsignedExpGolomb();return 1&a?1+a>>>1:-1*(a>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()},b.exports=d},{}],55:[function(a,b,c){"use strict";var d=function(){this.init=function(){var a={};this.on=function(b,c){a[b]||(a[b]=[]),a[b].push(c)},this.off=function(b,c){var d;return!!a[b]&&(d=a[b].indexOf(c),a[b].splice(d,1),d>-1)},this.trigger=function(b){var c,d,e,f;if(c=a[b])if(2===arguments.length)for(e=c.length,d=0;d<e;++d)c[d].call(this,arguments[1]);else{for(f=[],d=arguments.length,d=1;d<arguments.length;++d)f.push(arguments[d]);for(e=c.length,d=0;d<e;++d)c[d].apply(this,f)}},this.dispose=function(){a={}}}};d.prototype.pipe=function(a){return this.on("data",function(b){a.push(b)}),this.on("done",function(b){a.flush(b)}),a},d.prototype.push=function(a){this.trigger("data",a)},d.prototype.flush=function(a){this.trigger("done",a)},b.exports=d},{}],56:[function(a,b,c){var d=arguments[3],e=arguments[4],f=arguments[5],g=JSON.stringify;b.exports=function(a){for(var c,h=Object.keys(f),i=0,j=h.length;i<j;i++){var k=h[i];if(f[k].exports===a){c=k;break}}if(!c){c=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var l={},i=0,j=h.length;i<j;i++){var k=h[i];l[k]=k}e[c]=[Function(["require","module","exports"],"("+a+")(self)"),l]}var m=Math.floor(Math.pow(16,8)*Math.random()).toString(16),n={};n[c]=c,e[m]=[Function(["require"],"require("+g(c)+")(self)"),n];var o="("+d+")({"+Object.keys(e).map(function(a){return g(a)+":["+e[a][0]+","+g(e[a][1])+"]"}).join(",")+"},{},["+g(m)+"])",p=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(p.createObjectURL(new Blob([o],{type:"text/javascript"})))}},{}],57:[function(a,b,c){(function(c){"use strict";function f(a){return a&&a.__esModule?a:{default:a}}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(b,c,d){for(var e=!0;e;){var f=b,g=c,h=d;e=!1,null===f&&(f=Function.prototype);var i=Object.getOwnPropertyDescriptor(f,g);if(void 0!==i){if("value"in i)return i.value;var k=i.get;if(void 0===k)return;return k.call(h)}var j=Object.getPrototypeOf(f);if(null===j)return;b=j,c=g,d=h,e=!0,i=j=void 0}},i=a("global/document"),j=f(i),k=a("./playlist-loader"),l=f(k),m=a("./playlist"),n=f(m),o=a("./xhr"),p=f(o),q=a("./decrypter"),r=a("./bin-utils"),s=f(r),t=a("videojs-contrib-media-sources"),u=a("./m3u8"),v=f(u),w="undefined"!=typeof window?window.videojs:void 0!==c?c.videojs:null,x=f(w),y=a("./master-playlist-controller"),z=f(y),A=function(b,c){if(typeof b!=typeof c)return!0;if(Object.keys(b).length!==Object.keys(c).length)return!0;for(var d in b)if(!c[d]||b[d]!==c[d])return!0;return!1},B={PlaylistLoader:l.default,Playlist:n.default,Decrypter:q.Decrypter,AsyncStream:q.AsyncStream,decrypt:q.decrypt,utils:s.default,xhr:(0,p.default)()};B.GOAL_BUFFER_LENGTH=30;var D=function(b,c){var d=void 0;return b?(d=getComputedStyle(b),d?d[c]:""):""};B.STANDARD_PLAYLIST_SELECTOR=function(){var b=this.playlists.master.playlists.slice(),c=[],d=+new Date,e=void 0,f=void 0,g=void 0,h=void 0,i=void 0,j=void 0,k=void 0,l=void 0;for(b.sort(B.comparePlaylistBandwidth),b=b.filter(function(a){return void 0===a.excludeUntil||d>=a.excludeUntil}),e=b.length;e--;)f=b[e],f.attributes&&f.attributes.BANDWIDTH&&1.2*f.attributes.BANDWIDTH<this.bandwidth&&(c.push(f),g||(g=f));for(e=c.length,c.sort(B.comparePlaylistResolution),f=null,k=parseInt(D(this.tech_.el(),"width"),10),l=parseInt(D(this.tech_.el(),"height"),10);e--;)if(f=c[e],f.attributes&&f.attributes.RESOLUTION&&f.attributes.RESOLUTION.width&&f.attributes.RESOLUTION.height){var m=f.attributes.RESOLUTION;if(m.width===k&&m.height===l){h=null,j=f;break}if(m.width<k&&m.height<l)break;(!h||m.width<i.width&&m.height<i.height)&&(h=f,i=h.attributes.RESOLUTION)}return h||j||g||b[0]},B.canPlaySource=function(){return x.default.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")},B.supportsNativeHls=function(){var a=j.default.createElement("video");return!!x.default.getComponent("Html5").isSupported()&&["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(b){return/maybe|probably/i.test(a.canPlayType(b))})}(),B.isSupported=function(){return x.default.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var E=x.default.getComponent("Component"),F=function(a){function b(a,c,d){var f=this;if(g(this,b),e(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,c),c.options_&&c.options_.playerId){var h=(0,x.default)(c.options_.playerId);h.hasOwnProperty("hls")||Object.defineProperty(h,"hls",{get:function(){return x.default.log.warn("player.hls is deprecated. Use player.tech.hls instead."),f}})}this.options_=x.default.mergeOptions(x.default.options.hls||{},d.hls),this.tech_=c,this.source_=a,this.bandwidth=this.options_.bandwidth||4194304,this.bytesReceived=0,this.on(j.default,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(a){var b=j.default.fullscreenElement||j.default.webkitFullscreenElement||j.default.mozFullScreenElement||j.default.msFullscreenElement;b&&b.contains(f.tech_.el())&&f.masterPlaylistController_.fastQualityChange_()}),this.on(this.tech_,"seeking",function(){this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),this.audioTrackChange_=function(){f.masterPlaylistController_.useAudio()},this.on(this.tech_,"play",this.play)}return h(b,a),d(b,[{key:"src",value:function(b){var c=this;b&&(["withCredentials","bandwidth"].forEach(function(a){void 0!==c.source_[a]&&(c.options_[a]=c.source_[a])}),this.options_.url=this.source_.src,this.options_.tech=this.tech_,this.options_.externHls=B,this.options_.bandwidth=this.bandwidth,this.masterPlaylistController_=new z.default(this.options_),this.masterPlaylistController_.selectPlaylist=B.STANDARD_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(b){this.masterPlaylistController_.selectPlaylist=b.bind(this)}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(b){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=b}}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.masterPlaylistController_.on("sourceopen",function(){c.tech_.audioTracks().addEventListener("change",c.audioTrackChange_)}),this.masterPlaylistController_.on("audioinfo",function(a){if(!x.default.browser.IS_FIREFOX||!c.audioInfo_||!A(c.audioInfo_,a.info))return void(c.audioInfo_=a.info);var b="had different audio properties (channels, sample rate, etc.) or changed in some other way.  This behavior is currently unsupported in Firefox due to an issue: \n\nhttps://bugzilla.mozilla.org/show_bug.cgi?id=1247138\n\n",d=void 0,e=void 0;c.masterPlaylistController_.audioTracks_.forEach(function(a){!e&&a.default&&(e=a),!d&&a.enabled&&(d=a)}),d.getLoader(c.activeAudioGroup_())?(b="The audio track '"+d.label+"' that we tried to switch to "+b+" Unfortunately this means we will have to return you to the main track '"+e.label+"'. Sorry!",e.enabled=!0,c.tech_.audioTracks().removeTrack(d)):(b="The rendition that we tried to switch to "+b+"Unfortunately that means we will have to blacklist the current playlist and switch to another. Sorry!",c.masterPlaylistController_.blacklistCurrentPlaylist()),x.default.log.warn(b),c.masterPlaylistController_.useAudio()}),this.masterPlaylistController_.on("selectedinitialmedia",function(){c.tech_.clearTracks("audio"),c.masterPlaylistController_.audioTracks_.forEach(function(a){c.tech_.audioTracks().addTrack(a)})}),this.on(this.masterPlaylistController_,"progress",function(){this.bandwidth=this.masterPlaylistController_.mainSegmentLoader_.bandwidth,this.tech_.trigger("progress")}),this.tech_.el()&&this.tech_.src(x.default.URL.createObjectURL(this.masterPlaylistController_.mediaSource)))}},{key:"activeAudioGroup_",value:function(){return this.masterPlaylistController_.activeAudioGroup()}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(b){this.masterPlaylistController_.setCurrentTime(b)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.tech_.audioTracks().removeEventListener("change",this.audioTrackChange_),e(Object.getPrototypeOf(b.prototype),"dispose",this).call(this)}}]),b}(E),G=function a(b){return{canHandleSource:function(d){return(!x.default.options.hls||!x.default.options.hls.mode||x.default.options.hls.mode===b)&&a.canPlayType(d.type)},handleSource:function(c,d,e){"flash"===b&&d.setTimeout(function(){d.trigger("loadstart")},1);var f=x.default.mergeOptions(e,{hls:{mode:b}});return d.hls=new F(c,d,f),d.hls.xhr=(0,p.default)(),x.default.Hls.xhr.beforeRequest&&(d.hls.xhr.beforeRequest=x.default.Hls.xhr.beforeRequest),d.hls.src(c.src),d.hls},canPlayType:function(c){return a.canPlayType(c)?"maybe":""}}};B.comparePlaylistBandwidth=function(a,b){var c=void 0,d=void 0;return a.attributes&&a.attributes.BANDWIDTH&&(c=a.attributes.BANDWIDTH),c=c||window.Number.MAX_VALUE,b.attributes&&b.attributes.BANDWIDTH&&(d=b.attributes.BANDWIDTH),d=d||window.Number.MAX_VALUE,c-d},B.comparePlaylistResolution=function(a,b){var c=void 0,d=void 0;return a.attributes&&a.attributes.RESOLUTION&&a.attributes.RESOLUTION.width&&(c=a.attributes.RESOLUTION.width),c=c||window.Number.MAX_VALUE,b.attributes&&b.attributes.RESOLUTION&&b.attributes.RESOLUTION.width&&(d=b.attributes.RESOLUTION.width),d=d||window.Number.MAX_VALUE,c===d&&a.attributes.BANDWIDTH&&b.attributes.BANDWIDTH?a.attributes.BANDWIDTH-b.attributes.BANDWIDTH:c-d},G.canPlayType=function(a){var b=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i;return!B.supportsNativeHls&&b.test(a)},void 0!==x.default.MediaSource&&void 0!==x.default.URL||(x.default.MediaSource=t.MediaSource,x.default.URL=t.URL),t.MediaSource.supportsNativeMediaSources()&&x.default.getComponent("Html5").registerSourceHandler(G("html5")),window.Uint8Array&&x.default.getComponent("Flash").registerSourceHandler(G("flash")),x.default.HlsHandler=F,x.default.HlsSourceHandler=G,x.default.Hls=B,x.default.m3u8=v.default,x.default.registerComponent("Hls",B),x.default.options.hls=x.default.options.hls||{},b.exports={Hls:B,HlsHandler:F,HlsSourceHandler:G}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./bin-utils":1,"./decrypter":5,"./m3u8":7,"./master-playlist-controller":11,"./playlist":13,"./playlist-loader":12,"./xhr":19,"global/document":21,"videojs-contrib-media-sources":34}]},{},[57])(57)});